<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
   <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Open+Sans:wght@300;400;600;700&family=Lato:wght@300;400;700&family=Montserrat:wght@300;400;600;700&family=Poppins:wght@300;400;600;700&family=Playfair+Display:wght@400;700&family=Merriweather:wght@300;400;700&family=Source+Sans+Pro:wght@300;400;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: Arial, sans-serif;
            background: #f5f5f5;
            color: #333;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: linear-gradient(135deg, #c8102e 0%, #8b0b1f 100%);
            color: white;
            padding: 30px;
            text-align: center;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        
        .controls {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            display: flex;
            gap: 10px;
            flex-wrap: nowrap;
        }
        .controls .btn,
        .controls select {
           white-space: nowrap;
           flex-shrink: 0;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
        }
        
        .btn-primary { background: #667eea; color: white; }
        .btn-add { background: #38a169; color: white; margin-top: 10px; margin-bottom: 25px; }
        .btn-remove { background: #e53e3e; color: white; }
        .btn-small { padding: 6px 12px; font-size: 12px; }
        
        select, input, textarea {
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        .form-section, .preview-section {
            background: white;
            padding: 30px;
            border-radius: 10px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #4a5568;
        }
        
        .form-group input, .form-group textarea {
            width: 100%;
        }
        
        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }
        
        .section-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #2d3748;
            border-bottom: 2px solid #667eea;
            padding-bottom: 5px;
        }
        
        .dynamic-section {
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            background: #f9f9f9;
            position: relative;
        }
        
        .remove-btn {
            position: absolute;
            top: 10px;
            right: 10px;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .skill-item {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            align-items: center;
        }
        
        .skill-item input { flex: 1; }
        .skill-item select { width: 120px; }
        
        .resume-preview {
            background: white;
            padding: 40px;
            min-height: 600px;
        }
        
       /* PLANTILLA MODERNA */
.template-modern .name {
    font-size: 32px;
    color: #2d3748;
    margin-bottom: 10px;
    font-weight: bold;
}

.template-modern .resume-header {
    border-bottom: 3px solid #667eea;
    padding-bottom: 20px;
    margin-bottom: 30px;
}

.template-modern .contact-info {
    font-size: 14px;
    color: #718096;
}

.template-modern .resume-section h3 {
    color: #2d3748;
    border-bottom: 2px solid #667eea;
    padding-bottom: 5px;
    margin-bottom: 15px;
    font-size: 18px;
}

/* PLANTILLA CREATIVA */
.template-creative .resume-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 30px;
    margin: -40px -40px 30px -40px;
    text-align: center;
    border-radius: 0;
}

.template-creative .name {
    font-size: 32px;
    margin-bottom: 10px;
    font-weight: bold;
    color: white;
}

.template-creative .contact-info {
    font-size: 14px;
    color: rgba(255, 255, 255, 0.9);
}

.template-creative .resume-section h3 {
    color: #667eea;
    border-bottom: 2px solid #667eea;
    padding-bottom: 5px;
    margin-bottom: 15px;
    font-size: 18px;
}

/* PLANTILLA MINIMALISTA */
.template-minimal .resume-header {
    text-align: center;
    margin-bottom: 40px;
    border-bottom: 1px solid #e2e8f0;
    padding-bottom: 20px;
}

.template-minimal .name {
    font-size: 28px;
    font-weight: 300;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: #2d3748;
    margin-bottom: 10px;
}

.template-minimal .contact-info {
    font-size: 14px;
    color: #718096;
    font-weight: 300;
}

.template-minimal .resume-section h3 {
    color: #2d3748;
    border-bottom: 1px solid #e2e8f0;
    padding-bottom: 5px;
    margin-bottom: 15px;
    font-size: 16px;
    font-weight: 400;
    text-transform: uppercase;
    letter-spacing: 1px;
}

/* PLANTILLA ELEGANTE */
.template-elegant .resume-header {
    background-color: #1a202c;
    color: white;
    padding: 30px;
    text-align: center;
    margin: -40px -40px 30px -40px;
    border-radius: 0;
}

.template-elegant .name {
    font-size: 32px;
    margin-bottom: 10px;
    font-weight: bold;
    color: white;
    font-family: 'Georgia', serif;
}

.template-elegant .contact-info {
    font-size: 14px;
    color: #cbd5e0;
    font-style: italic;
}

.template-elegant .resume-section h3 {
    color: #1a202c;
    border-bottom: 2px solid #1a202c;
    padding-bottom: 5px;
    margin-bottom: 15px;
    font-size: 18px;
    font-family: 'Georgia', serif;
}

/* PLANTILLA CLARA */
.template-clean .resume-header {
    border-bottom: 3px solid #48bb78;
    padding-bottom: 20px;
    margin-bottom: 30px;
}

.template-clean .name {
    color: #2f855a;
    font-size: 30px;
    margin-bottom: 10px;
    font-weight: bold;
}

.template-clean .contact-info {
    font-size: 14px;
    color: #68d391;
}

.template-clean .resume-section h3 {
    color: #2f855a;
    border-bottom: 2px solid #48bb78;
    padding-bottom: 5px;
    margin-bottom: 15px;
    font-size: 18px;
}

.template-clean .skill-tag {
    background: #48bb78;
    color: white;
}

/* PLANTILLA CORPORATIVA */
.template-corporate .resume-header {
    background: linear-gradient(to right, #2b6cb0, #2c5282);
    color: white;
    padding: 25px;
    margin: -40px -40px 30px -40px;
    border-radius: 0;
}

.template-corporate .name {
    font-size: 30px;
    margin-bottom: 10px;
    font-weight: bold;
    color: white;
}

.template-corporate .contact-info {
    font-size: 14px;
    color: #bee3f8;
}

.template-corporate .resume-section h3 {
    color: #2b6cb0;
    border-bottom: 2px solid #2b6cb0;
    padding-bottom: 5px;
    margin-bottom: 15px;
    font-size: 18px;
    font-weight: bold;
}

.template-corporate .skill-tag {
    background: #2b6cb0;
    color: white;
}

/* PLANTILLA PROFESIONAL */
.template-professional {
    display: grid;
    grid-template-columns: 300px 1fr;
    gap: 40px;
    padding: 40px;
}

.template-professional .resume-header {
    grid-column: 1 / -1;
    border-bottom: 3px solid #2d3748;
    padding: 25px 30px 20px 30px;
    margin: -40px -40px -10px -40px;
    background: #faf9f7;
    position: relative;
}

.template-professional .name {
    font-size: 36px;
    font-weight: bold;
    color: #2d3748;
    margin-bottom: 15px;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.template-professional .contact-info {
    position: static;
    right: auto;
    bottom: auto;
    text-align: left;
    font-size: 14px;
    color: #4a5568;
    margin-bottom: 0;
}

.template-professional .contact-info span {
    display: block;
    margin-bottom: 5px;
}

.template-professional .resume-summary {
    grid-column: 1 / -1;
    text-align: center;
    margin-bottom: 30px;
    padding: 20px;
    background: #f7fafc;
    border-radius: 8px;
}

.template-professional .resume-summary h3 {
    font-size: 20px;
    text-transform: uppercase;
    letter-spacing: 2px;
    color: #2d3748;
    margin-bottom: 15px;
    border: none;
}

.template-professional .left-column {
    grid-column: 1;
    border-right: 2px solid #e2e8f0;
    padding-right: 30px;
}

.template-professional .right-column {
    grid-column: 2;
    padding-left: 10px;
}

.template-professional .resume-section h3 {
    color: #2d3748;
    font-size: 18px;
    text-transform: uppercase;
    letter-spacing: 1px;
    border-bottom: 2px solid #2d3748;
    padding-bottom: 8px;
    margin-bottom: 20px;
}

.template-professional .experience-item,
.template-professional .education-item {
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid #e2e8f0;
}

.template-professional .job-title,
.template-professional .degree-title {
    font-weight: bold;
    color: #2d3748;
    font-size: 16px;
}

.template-professional .company-info,
.template-professional .institution-info {
    color: #718096;
    font-size: 14px;
    margin-bottom: 8px;
    font-style: italic;
}

.template-professional .skills-category h4 {
    color: #2d3748;
    font-size: 16px;
    margin-bottom: 10px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.template-professional .skill-tag {
    background: #2d3748;
    color: white;
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 500;
    margin-bottom: 8px;
}

	/* PLANTILLA BERLIN - ESTILO RESUME.IO */
.template-berlin {
    display: grid;
    grid-template-columns: 300px 1fr;
    gap: 0;
    padding: 0;
    background: white;
}

.template-berlin .resume-header {
    grid-column: 1 / -1;
    background: linear-gradient(135deg, #1e3a8a 0%, #0f172a 100%);
    color: white;
    padding: 40px;
    margin: 0;
    text-align: center;
}

.template-berlin .name {
    font-size: 32px;
    font-weight: 700;
    margin-bottom: 20px;
    color: white;
}

.template-berlin .contact-info {
    font-size: 16px;
    color: rgba(255, 255, 255, 0.95);
    display: flex;
    gap: 30px;
    justify-content: center;
    flex-wrap: wrap;
}

.template-berlin .contact-info span {
    position: relative;
    padding-left: 25px;
}

.template-berlin .contact-info span::before {
    position: absolute;
    left: 0;
    font-size: 16px;
}

.template-berlin .contact-info span:nth-child(1)::before { content: ""; }
.template-berlin .contact-info span:nth-child(2)::before { content: ""; }
.template-berlin .contact-info span:nth-child(3)::before { content: ""; }
.template-berlin .contact-info span:nth-child(4)::before { content: ""; }

.template-berlin .resume-summary {
    grid-column: 1 / -1;
    background: #f8fafc;
    padding: 30px 40px;
    margin: 0;
}

.template-berlin .resume-summary h3 {
    color: #1e40af;
    font-size: 20px;
    font-weight: 700;
    margin-bottom: 15px;
    text-transform: uppercase;
    border-bottom: 3px solid #3b82f6;
    padding-bottom: 8px;
}

.template-berlin .left-column {
    grid-column: 1;
    background: linear-gradient(135deg, #1e3a8a 0%, #0f172a 100%);
    color: white;
    padding: 30px 30px 50px 30px;
    min-height: 100%;
}

.template-berlin .left-column .resume-section {
    background: rgba(255, 255, 255, 0.1);
    padding: 20px;
    border-radius: 10px;
    margin-bottom: 50px;
    border-left: 4px solid rgba(255, 255, 255, 0.3);
}

.template-berlin .left-column .resume-section h3 {
    color: white;
    border-bottom: 2px solid rgba(255, 255, 255, 0.3);
    font-size: 18px;
    margin-bottom: 15px;
    padding-bottom: 8px;
}

.template-berlin .left-column .education-item {
    margin-bottom: 15px;
    padding-bottom: 15px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.2);
}

.template-berlin .left-column .degree-title {
    color: white;
    font-size: 16px;
    font-weight: 600;
    margin-bottom: 5px;
}

.template-berlin .left-column .institution-info {
    color: rgba(255, 255, 255, 0.8);
    font-size: 13px;
}

.template-berlin .left-column .skill-tag {
    background: rgba(255, 255, 255, 0.2);
    color: white;
    border: 1px solid rgba(255, 255, 255, 0.3);
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 500;
    margin-right: 8px;
    margin-bottom: 8px;
    display: inline-block;
}

.template-berlin .right-column {
    grid-column: 2;
    padding: 40px;
    background: white;
}

.template-berlin .right-column .resume-section h3 {
    color: #1e40af;
    font-size: 20px;
    font-weight: 700;
    margin-bottom: 20px;
    text-transform: uppercase;
    border-bottom: 3px solid #3b82f6;
    padding-bottom: 8px;
}

.template-berlin .right-column .experience-item {
    margin-bottom: 20px;
    padding-left: 20px;
    border-left: 3px solid #e5e7eb;
    position: relative;
}

.template-berlin .right-column .experience-item::before {
    content: "";
    position: absolute;
    left: -8px;
    top: 5px;
    width: 13px;
    height: 13px;
    background: #3b82f6;
    border-radius: 50%;
    border: 3px solid white;
    box-shadow: 0 0 0 2px #3b82f6;
}

.template-berlin .right-column .job-title {
    font-weight: 700;
    font-size: 18px;
    color: #1f2937;
    margin-bottom: 8px;
}

.template-berlin .right-column .company-info {
    color: #6b7280;
    font-size: 14px;
    margin-bottom: 12px;
    font-weight: 500;
}

.template-berlin .right-column .job-description {
    color: #4b5563;
    line-height: 1.6;
    font-size: 14px;
}

/* PLANTILLA VIENNA - GRIS EJECUTIVO CON DETALLES DORADOS */
.template-vienna {
    display: grid;
    grid-template-columns: 320px 1fr;
    gap: 0;
    padding: 0;
    background: white;
}

.template-vienna .resume-header {
    grid-column: 1 / -1;
    background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
    color: white;
    padding: 40px;
    margin: 0;
    text-align: center;
    position: relative;
}

.template-vienna .resume-header::after {
    content: "";
    position: absolute;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 60px;
    height: 4px;
    background: linear-gradient(90deg, #d69e2e, #f6e05e);
}

.template-vienna .name {
    font-size: 32px;
    font-weight: 700;
    margin-bottom: 20px;
    color: white;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.template-vienna .contact-info {
    font-size: 16px;
    color: rgba(255, 255, 255, 0.9);
    display: flex;
    gap: 25px;
    justify-content: center;
    flex-wrap: wrap;
}

.template-vienna .contact-info span {
    position: relative;
    padding-left: 28px;
    padding: 8px 8px 8px 28px;
    background: rgba(214, 158, 46, 0.2);
    border-radius: 20px;
    border: 1px solid rgba(214, 158, 46, 0.3);
}

.template-vienna .contact-info span::before {
    position: absolute;
    left: 8px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 14px;
}

.template-vienna .contact-info span:nth-child(1)::before { content: ""; }
.template-vienna .contact-info span:nth-child(2)::before { content: ""; }
.template-vienna .contact-info span:nth-child(3)::before { content: ""; }
.template-vienna .contact-info span:nth-child(4)::before { content: ""; }

.template-vienna .resume-summary {
    grid-column: 1 / -1;
    background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
    padding: 35px 40px;
    margin: 0;
    border-bottom: 1px solid #e2e8f0;
}

.template-vienna .resume-summary h3 {
    color: #2d3748;
    font-size: 22px;
    font-weight: 700;
    margin-bottom: 18px;
    text-transform: uppercase;
    border-bottom: 3px solid #d69e2e;
    padding-bottom: 10px;
    letter-spacing: 1px;
}

.template-vienna .resume-summary p {
    color: #4a5568;
    line-height: 1.7;
    font-size: 15px;
    font-style: italic;
}

.template-vienna .left-column {
    grid-column: 1;
    background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%);
    color: white;
    padding: 30px 30px 60px 30px;
    min-height: 100%;
}

.template-vienna .left-column .resume-section {
    background: rgba(255, 255, 255, 0.08);
    padding: 25px;
    border-radius: 12px;
    margin-bottom: 30px;
    border: 1px solid rgba(214, 158, 46, 0.3);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.template-vienna .left-column .resume-section:last-child {
    margin-bottom: 0;
}

.template-vienna .left-column .resume-section h3 {
    color: #f6e05e;
    border-bottom: 2px solid rgba(214, 158, 46, 0.5);
    font-size: 18px;
    margin-bottom: 20px;
    padding-bottom: 10px;
    text-transform: uppercase;
    letter-spacing: 1px;
    font-weight: 600;
}

.template-vienna .left-column .education-item {
    margin-bottom: 20px;
    padding: 15px;
    background: rgba(214, 158, 46, 0.1);
    border-radius: 8px;
    border-left: 4px solid #d69e2e;
}

.template-vienna .left-column .degree-title {
    color: white;
    font-size: 16px;
    font-weight: 600;
    margin-bottom: 8px;
}

.template-vienna .left-column .institution-info {
    color: rgba(255, 255, 255, 0.8);
    font-size: 14px;
    margin-bottom: 5px;
}

.template-vienna .left-column .skills-category {
    margin-bottom: 25px;
}

.template-vienna .left-column .skills-category h4 {
    color: #f6e05e;
    font-size: 16px;
    font-weight: 600;
    margin-bottom: 15px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.template-vienna .left-column .skill-tag {
    background: linear-gradient(135deg, #d69e2e 0%, #f6e05e 100%);
    color: #2d3748;
    padding: 8px 14px;
    border-radius: 25px;
    font-size: 12px;
    font-weight: 600;
    margin-right: 8px;
    margin-bottom: 10px;
    display: inline-block;
    box-shadow: 0 2px 8px rgba(214, 158, 46, 0.3);
}

.template-vienna .right-column {
    grid-column: 2;
    padding: 40px;
    background: white;
}

.template-vienna .right-column .resume-section {
    margin-bottom: 40px;
    background: #f9f9f9;
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    border-left: 5px solid #d69e2e;
}

.template-vienna .right-column .resume-section h3 {
    color: #2d3748;
    font-size: 22px;
    font-weight: 700;
    margin-bottom: 25px;
    text-transform: uppercase;
    border-bottom: 3px solid #d69e2e;
    padding-bottom: 10px;
    letter-spacing: 1px;
}

.template-vienna .right-column .experience-item {
    margin-bottom: 25px;
    padding: 20px;
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    border-left: 4px solid #4a5568;
    position: relative;
}

.template-vienna .right-column .experience-item::before {
    content: "";
    position: absolute;
    left: -10px;
    top: 25px;
    width: 16px;
    height: 16px;
    background: linear-gradient(135deg, #d69e2e, #f6e05e);
    border-radius: 50%;
    border: 3px solid white;
    box-shadow: 0 0 0 2px #4a5568;
}

.template-vienna .right-column .job-title {
    font-weight: 700;
    font-size: 18px;
    color: #2d3748;
    margin-bottom: 10px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.template-vienna .right-column .company-info {
    color: #d69e2e;
    font-size: 14px;
    margin-bottom: 15px;
    font-weight: 600;
    text-transform: uppercase;
}

.template-vienna .right-column .job-description {
    color: #4a5568;
    line-height: 1.6;
    font-size: 14px;
}
        
        .contact-info {
            font-size: 14px;
        }
        
        .resume-section {
            margin-bottom: 25px;
        }
        
        .resume-section h3 {
            color: #2d3748;
            border-bottom: 2px solid #667eea;
            padding-bottom: 5px;
            margin-bottom: 15px;
        }
        
        .experience-item, .education-item {
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .job-title, .degree-title {
            font-weight: bold;
            color: #2d3748;
        }
        
        .company-info, .institution-info {
            color: #718096;
            font-size: 14px;
            margin-bottom: 5px;
        }
        
        .skills-category {
            margin-bottom: 15px;
        }
        
        .skills-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .skill-tag {
            background: #667eea;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
        }
        
	@media (max-width: 768px) {
    	    .container { padding: 10px; }
    	    .header { padding: 20px; font-size: 14px; }
    	    .controls { 
             flex-direction: column; 
             gap: 10px; 
    	}
    	    .controls select, .controls button { 
             width: 100%; 
             margin-bottom: 5px; 
    	}
    	    .main-content { 
            grid-template-columns: 1fr; 
            gap: 20px; 
   	}
    	    .form-row { 
            grid-template-columns: 1fr; 
    	}
    	    .form-section, .preview-section { 
            padding: 15px; 
            max-height: none; 
    	}
    	    .resume-preview { 
            padding: 20px; 
            font-size: 12px; 
    	}
    	    .template-professional { 
            grid-template-columns: 1fr; 
            gap: 20px; 
    	}
    	    .template-professional .left-column { 
            border-right: none; 
            border-bottom: 1px solid #e2e8f0; 
            padding-right: 0; 
            padding-bottom: 20px; 
    	}
@media (max-width: 1024px) and (min-width: 769px) {
    .container { max-width: 100%; }
    .controls { gap: 8px; }
    .main-content { gap: 20px; }
    .template-professional { gap: 20px; }
	}

}

	.font-arial { font-family: Arial, sans-serif; }
        .font-times { font-family: 'Times New Roman', serif; }
        .font-helvetica { font-family: 'Inter', 'Helvetica Neue', Helvetica, Arial, sans-serif; }
        .font-georgia { font-family: Georgia, serif; }
        .font-calibri { font-family: Calibri, Arial, sans-serif; }
        .font-verdana { font-family: Verdana, Arial, sans-serif; }
        .font-tahoma { font-family: Tahoma, Arial, sans-serif; }
        .font-trebuchet { font-family: 'Trebuchet MS', Arial, sans-serif; }
	.font-roboto { font-family: 'Roboto', Arial, sans-serif; }
	.font-opensans { font-family: 'Open Sans', Arial, sans-serif; }
	.font-lato { font-family: 'Lato', Arial, sans-serif; }
	.font-montserrat { font-family: 'Montserrat', Arial, sans-serif; }
	.font-poppins { font-family: 'Poppins', Arial, sans-serif; }
	.font-playfair { font-family: 'Playfair Display', Georgia, serif; }
	.font-merriweather { font-family: 'Merriweather', Georgia, serif; }
	.font-source-sans { font-family: 'Source Sans Pro', Arial, sans-serif; }

	.font-size-12 { font-size: 12px !important; }
	.font-size-14 { font-size: 14px !important; }
	.font-size-16 { font-size: 16px !important; }
	.font-size-18 { font-size: 18px !important; }

	.font-size-12 .name { font-size: 28px !important; }
	.font-size-14 .name { font-size: 32px !important; }
	.font-size-16 .name { font-size: 36px !important; }
	.font-size-18 .name { font-size: 40px !important; }
        
.skill-selection-container {
    margin: 15px 0;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 5px;
}

.skill-checkboxes {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 10px;
    margin-top: 10px;
    max-height: 200px;
    overflow-y: auto;
    padding: 10px;
    border: 1px solid #e2e8f0;
    border-radius: 5px;
    background: white;
}

.skill-checkbox-item {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 5px;
}

.skill-checkbox-item input[type="checkbox"] {
    width: auto;
    margin: 0;
}

.skill-checkbox-item label {
    margin: 0;
    cursor: pointer;
    font-weight: normal;
}

.selected-skills-display {
    margin-top: 15px;
}

.selected-skills-display h5 {
    font-size: 14px;
    margin-bottom: 8px;
    color: #4a5568;
}

.custom-skill-section {
    margin-top: 20px;
    padding: 15px;
    background: #e8f4fd;
    border-radius: 5px;
    border: 1px dashed #667eea;
}

.custom-skill-input-container {
    display: flex;
    gap: 10px;
    margin-top: 8px;
    align-items: center;
}

.custom-skill-input {
    flex: 1;
    padding: 8px 12px;
    border: 2px solid #e2e8f0;
    border-radius: 5px;
    font-size: 14px;
}

.custom-skill-input:focus {
    outline: none;
    border-color: #667eea;
}

.custom-skill-item {
    background: #f0f9ff;
    border: 1px solid #bae6fd;
    border-radius: 5px;
    padding: 8px;
    display: flex;
    align-items: center;
    gap: 8px;
}

.custom-skill-item label {
    font-style: italic;
    color: #0369a1;
}

.custom-skill-item .btn-remove {
    width: 20px;
    height: 20px;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    line-height: 1;
}

/* Estilos para la encuesta de satisfacci贸n */
.survey-modal {
    position: fixed;
    z-index: 1001;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.6);
    display: flex;
    justify-content: center;
    align-items: center;
}

.survey-modal-content {
    background: white;
    border-radius: 15px;
    width: 90%;
    max-width: 600px;
    max-height: 85vh;
    overflow-y: auto;
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
}

.survey-modal-header {
    background: linear-gradient(135deg, #c8102e 0%, #8b0b1f 100%);
    color: white;
    padding: 25px;
    border-radius: 15px 15px 0 0;
    text-align: center;
}

.survey-question {
    margin-bottom: 25px;
    padding: 20px;
    background: #f8f9fa;
    border-radius: 10px;
    border-left: 4px solid #c8102e;
}

.star-rating {
    display: flex;
    gap: 5px;
    justify-content: center;
    margin: 10px 0;
}

.star {
    font-size: 30px;
    color: #ddd;
    cursor: pointer;
    transition: color 0.2s;
}

.star:hover,
.star.active {
    color: #ffd700;
}

.scale-rating {
    display: flex;
    gap: 10px;
    justify-content: center;
    flex-wrap: wrap;
    margin: 15px 0;
}

.scale-option {
    padding: 10px 15px;
    border: 2px solid #e2e8f0;
    border-radius: 25px;
    cursor: pointer;
    transition: all 0.2s;
    background: white;
}

.scale-option:hover {
    border-color: #c8102e;
}

.scale-option.selected {
    background: #c8102e;
    color: white;
    border-color: #c8102e;
}

.checkbox-group {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 10px;
    margin: 15px 0;
}

.checkbox-item {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px;
}

.survey-buttons {
    display: flex;
    gap: 15px;
    justify-content: center;
    margin-top: 30px;
    padding: 20px;
    border-top: 1px solid #e2e8f0;
}

.survey-buttons .btn {
    padding: 12px 25px;
    font-size: 16px;
    min-width: 120px;
}

.satisfaction-options {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin: 15px 0;
}

.satisfaction-option {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 12px 15px;
    border: 2px solid #e2e8f0;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.2s;
    background: white;
}

.satisfaction-option:hover {
    border-color: #c8102e;
    background: #fef7f7;
}

.satisfaction-option input[type="radio"] {
    width: auto;
    margin: 0;
}

.satisfaction-option input[type="radio"]:checked + span {
    font-weight: 600;
    color: #c8102e;
}

.satisfaction-option:has(input[type="radio"]:checked) {
    border-color: #c8102e;
    background: #fef7f7;
}

/* Modal de Carta de Presentaci贸n Profesional */
.professional-letter-modal {
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.5);
    display: none;
    justify-content: center;
    align-items: center;
}

.professional-letter-content {
    background: white;
    border-radius: 15px;
    width: 95%;
    max-width: 1200px;
    height: 90vh;
    display: grid;
    grid-template-columns: 400px 1fr;
    gap: 20px;
    overflow: hidden;
}

.letter-form-section {
    padding: 20px;
    overflow-y: auto;
    border-right: 1px solid #e2e8f0;
}

.letter-preview-section {
    padding: 20px;
    overflow-y: auto;
    background: #f9f9f9;
}

.letter-header {
    background: linear-gradient(135deg, #c8102e 0%, #8b0b1f 100%);
    color: white;
    padding: 20px;
    text-align: center;
    grid-column: 1 / -1;
    margin: 0;
}

.letter-preview-content {
    background: white;
    padding: 40px;
    font-family: 'Times New Roman', serif;
    font-size: 12pt;
    line-height: 1.6;
    color: #000;
    min-height: 800px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.letter-buttons {
    grid-column: 1 / -1;
    display: flex;
    gap: 10px;
    justify-content: center;
    padding: 15px;
    border-top: 1px solid #e2e8f0;
    background: white;
}

@media (max-width: 1000px) {
    .professional-letter-content {
        grid-template-columns: 1fr;
        height: 95vh;
    }
    
    .letter-form-section {
        border-right: none;
        border-bottom: 1px solid #e2e8f0;
    }
}

/* Estilos para el modal de salir */
.email-modal {
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.5);
    display: flex;
    justify-content: center;
    align-items: center;
}

.email-modal-content {
    background: white;
    border-radius: 10px;
    width: 90%;
    max-width: 500px;
    max-height: 80vh;
    overflow-y: auto;
    box-shadow: 0 4px 20px rgba(0,0,0,0.3);
}

.email-modal-header {
    padding: 20px;
    border-bottom: 1px solid #e2e8f0;
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: white;
    border-radius: 10px 10px 0 0;
}

.email-modal-header h3 {
    margin: 0;
    color: #2d3748;
}

.email-modal-body {
    padding: 20px;
    background: white;
    border-radius: 0 0 10px 10px;
}

.email-modal-buttons {
    display: flex;
    gap: 10px;
    justify-content: center;
    margin-top: 20px;
}

}


    </style>
</head>
<body>
    <div class="container">
       <div class="header" style="position: relative; padding-left: 150px;">
    <img src="logo blanco.png" alt="logo blanco" style="position: absolute; height: 150px; left: 40px; top: 50%; transform: translateY(-50%);">
    <p style="font-size: 22px; margin-bottom: 2px;">Universidad Ana G. M茅ndez</p>
    <p style="font-size: 20px; margin-bottom: 5px;">Oficina de Carreras y Colocaciones Recinto de Cupey</p>
    <h1 id="app-title">UAGM Resume Builder Pro</h1>
    <p id="app-subtitle">Crea tu resum茅 profesional en minutos</p>
    <p style="position: absolute; bottom: 10px; right: 20px; font-size: 11px; opacity: 0.7; margin: 0;">Desarrollado por: Braulio Gonz谩lez V茅lez | @ 2025</p>
</div>

        <div class="controls">
            <select id="language-select">
                <option value="es">Espa帽ol</option>
                <option value="en">English</option>
            </select>
            <select id="template-select">
    <option value="modern">Moderno</option>
    <option value="creative">Creativo</option>
    <option value="minimal">Minimalista</option>
    <option value="elegant">Elegante</option>
    <option value="clean">Clara</option>
    <option value="corporate">Corporativa</option>
    <option value="professional">Profesional</option>
    <option value="berlin">Berlin</option>
    <option value="vienna">Vienna</option>
</select>

	    <select id="font-select">
    		<option value="arial">Arial</option>
   		<option value="times">Times New Roman</option>
    		<option value="helvetica">Helvetica</option>
    		<option value="georgia">Georgia</option>
    		<option value="calibri">Calibri</option>
    		<option value="verdana">Verdana</option>
    		<option value="tahoma">Tahoma</option>
    		<option value="trebuchet">Trebuchet MS</option>
		<option value="roboto">Roboto</option>
    		<option value="opensans">Open Sans</option>
   		<option value="lato">Lato</option>
    		<option value="montserrat">Montserrat</option>
    		<option value="poppins">Poppins</option>
    		<option value="playfair">Playfair Display</option>
    		<option value="merriweather">Merriweather</option>
    		<option value="source-sans">Source Sans Pro</option>
	    </select>

	    <select id="font-size-select">
    	        <option value="12">Peque帽o (12px)</option>
                <option value="14" selected>Normal (14px)</option>
                <option value="16">Grande (16px)</option>
                <option value="18">Extra Grande (18px)</option>
            </select>

            <button class="btn btn-primary" onclick="exportToPDF()">Exportar PDF</button>
            <button class="btn btn-primary" onclick="exportToWord()">Exportar Word</button>
            <button class="btn btn-primary" onclick="clearAll()">Reiniciar</button>
            <button class="btn btn-primary" onclick="openProfessionalCoverLetter()"> Crear Carta de Presentaci贸n</button>
	    <button class="btn btn-primary" onclick="openExitModal()"> Salir</button>
        </div>

        <div class="main-content">
            <div class="form-section">
                <h2 class="section-title" id="personal-info-title">Informaci贸n Personal</h2>
                <div class="form-group">
                    <label id="name-label">Nombre Completo</label>
                    <input type="text" id="name" placeholder="Juan P茅rez" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label id="email-label">Correo Electr贸nico</label>
                    <input type="email" id="email" placeholder="juan.perez@email.com" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label id="phone-label">Tel茅fono</label>
                    <input type="tel" id="phone" placeholder="+1 234 567 8900" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label id="location-label">Ubicaci贸n</label>
                    <input type="text" id="location" placeholder="Ciudad, Pa铆s" oninput="updatePreview()">
                </div>

                <h2 class="section-title" id="summary-title">Perfil Profesional</h2>
                <div class="form-group">
                    <textarea id="summary" placeholder="Profesional comprometido, proactivo y orientado a resultados, con habilidades en comunicaci贸n, trabajo en equipo y resoluci贸n de problemas. Capacidad para adaptarse a distintos 		    entornos laborales, aprender r谩pidamente y cumplir con metas establecidas." oninput="updatePreview()"></textarea>
                </div>

                <h2 class="section-title" id="experience-title">Experiencia Laboral</h2>
                <div id="experience-container"></div>
                <button class="btn btn-add btn-small" onclick="addExperience()" id="add-experience-btn">+ Agregar Experiencia</button>

                <h2 class="section-title" id="education-title">Educaci贸n</h2>
                <div id="education-container"></div>
                <button class="btn btn-add btn-small" onclick="addEducation()" id="add-education-btn">+ Agregar Educaci贸n</button>

                <h2 class="section-title" id="skills-title">Habilidades</h2>
                <div id="skills-container"></div>
                <button class="btn btn-add btn-small" onclick="addSkillCategory()" id="add-skill-btn">+ Agregar Categor铆a</button>

		<h2 class="section-title" id="certifications-title">Certificaciones y Adiestramientos</h2>
		<div id="certifications-container"></div>
		<button class="btn btn-add btn-small" onclick="addCertification()" id="add-certification-btn">+ Agregar Certificaci贸n</button>

		<h2 class="section-title" id="volunteer-title">Experiencia de Voluntariado e Internados</h2>
		<div id="volunteer-container"></div>
		<button class="btn btn-add btn-small" onclick="addVolunteer()" id="add-volunteer-btn">+ Agregar Voluntariado</button>
            </div>

            <div class="preview-section">
                <h2 class="section-title" id="preview-title">Vista Previa</h2>
                <div id="resume-preview" class="resume-preview template-modern font-arial font-size-14">
    <div class="resume-header">
        <h1 class="name" id="preview-name">Tu Nombre</h1>
        <div class="contact-info">
            <span id="preview-email">email@ejemplo.com</span>
            <span id="preview-phone">+1 234 567 8900</span>
            <span id="preview-location">Ciudad, Pa铆s</span>
        </div>
    </div>
    
    <div class="resume-summary resume-section">
        <h3 id="preview-summary-title">Perfil Profesional</h3>
        <p id="preview-summary">Profesional comprometido, proactivo y orientado a resultados, con habilidades en comunicaci贸n, trabajo en equipo y resoluci贸n de problemas. Capacidad para adaptarse a distintos entornos laborales, aprender r谩pidamente y cumplir con metas establecidas.</p>
    </div>

    <div class="left-column">
        <div class="resume-section">
            <h3 id="preview-education-title">Educaci贸n</h3>
            <div id="preview-education">Tu educaci贸n aparecer谩 aqu铆...</div>
        </div>

        <div class="resume-section">
            <h3 id="preview-skills-title">Habilidades</h3>
            <div id="preview-skills">Tus habilidades aparecer谩n aqu铆...</div>
        </div>
    </div>

    <div class="right-column">
    	<div class="resume-section">
            <h3 id="preview-experience-title">Experiencia Laboral</h3>
            <div id="preview-experience">Tu experiencia laboral aparecer谩 aqu铆...</div>
    </div>
    
    	<div class="resume-section">
             <h3 id="preview-certifications-title">Certificaciones</h3>
             <div id="preview-certifications">Tus certificaciones aparecer谩n aqu铆...</div>
    </div>
    
    	<div class="resume-section">
             <h3 id="preview-volunteer-title">Voluntariado</h3>
             <div id="preview-volunteer">Tu experiencia de voluntariado aparecer谩 aqu铆...</div>
    	</div>
    </div>
</div>

<script>
let currentLang = 'es';
let expCount = 0;
let eduCount = 0;
let skillCount = 0;
let certCount = 0;
let volunteerCount = 0;

const predefinedSkills = {
    es: {
        technical: [
            'Microsoft Office',
            'Excel',
            'PowerPoint',
            'Word',
            'Photoshop',
            'Adobe Creative Suite',
            'AutoCAD',
            'SAP',
            'QuickBooks',
            'SQL',
            'Python',
            'JavaScript',
            'HTML/CSS',
            'Redes Sociales',
            'Marketing Digital',
            'An谩lisis de Datos',
            'Contabilidad',
            'Administraci贸n',
            'Ventas',
            'Atenci贸n al Cliente'
        ],
        soft: [
            'Trabajo en Equipo',
            'Liderazgo',
            'Comunicaci贸n Efectiva',
            'Resoluci贸n de Problemas',
            'Pensamiento Cr铆tico',
            'Creatividad',
            'Adaptabilidad',
            'Organizaci贸n',
            'Gesti贸n del Tiempo',
            'Negociaci贸n',
            'Servicio al Cliente',
            'Multitarea',
            'Toma de Decisiones',
            'Planificaci贸n',
            'Iniciativa',
            'Responsabilidad',
            'Puntualidad',
            'Flexibilidad',
            'Paciencia',
            'Empat铆a'
        ]
    },
    en: {
        technical: [
            'Microsoft Office',
            'Excel',
            'PowerPoint',
            'Word',
            'Photoshop',
            'Adobe Creative Suite',
            'AutoCAD',
            'SAP',
            'QuickBooks',
            'SQL',
            'Python',
            'JavaScript',
            'HTML/CSS',
            'Social Media',
            'Digital Marketing',
            'Data Analysis',
            'Accounting',
            'Administration',
            'Sales',
            'Customer Service'
        ],
        soft: [
            'Teamwork',
            'Leadership',
            'Effective Communication',
            'Problem Solving',
            'Critical Thinking',
            'Creativity',
            'Adaptability',
            'Organization',
            'Time Management',
            'Negotiation',
            'Customer Service',
            'Multitasking',
            'Decision Making',
            'Planning',
            'Initiative',
            'Responsibility',
            'Punctuality',
            'Flexibility',
            'Patience',
            'Empathy'
        ]
    }
};

const texts = {
    es: {
        appTitle: "Resume Builder Pro",
        appSubtitle: "Crea tu resum茅 profesional en minutos",
        personalInfoTitle: "Informaci贸n Personal",
        nameLabel: "Nombre Completo",
        emailLabel: "Correo Electr贸nico",
        phoneLabel: "Tel茅fono",
        locationLabel: "Ubicaci贸n",
        summaryTitle: "Perfil Profesional",
        experienceTitle: "Experiencia Laboral",
        educationTitle: "Educaci贸n",
        skillsTitle: "Habilidades",
	certificationsTitle: "Certificaciones y Adiestramientos",
	volunteerTitle: "Voluntariado e Internados",
        previewTitle: "Vista Previa",
        addExperience: "+ Agregar Experiencia",
        addEducation: "+ Agregar Educaci贸n",
        addSkill: "+ Agregar Categor铆a",
	addCertification: "+ Agregar Certificaci贸n",
	addVolunteer: "+ Agregar Experiencia",
	volunteerRole: "Rol/Posici贸n",
	certificationName: "Certificaci贸n/Curso",
	organization: "Organizaci贸n",
	date: "Fecha",
	volunteerRole: "Rol/Posici贸n",
	volunteerOrg: "Organizaci贸n",
	volunteerDuration: "Duraci贸n",
	volunteerDescription: "Descripci贸n de actividades",
        position: "Posici贸n/Cargo",
        company: "Empresa",
        startDate: "Fecha Inicio",
        endDate: "Fecha Fin",
        current: "Trabajo Actual",
        tasks: "Tareas y Responsabilidades",
        degree: "T铆tulo/Grado",
        institution: "Instituci贸n",
        year: "A帽o",
        description: "Descripci贸n",
        skillCategory: "Categor铆a",
        skillName: "Habilidad",
        skillLevel: "Nivel",
        remove: "Eliminar",
        addSkillBtn: "+ Agregar Habilidad",
        levels: {
            beginner: "Principiante",
            intermediate: "Intermedio",
            advanced: "Avanzado",
            expert: "Experto"
        },
        templates: {
            modern: "Moderno",
            creative: "Creativo",
            minimal: "Minimalista",
            elegant: "Elegante",
            clean: "Clara",
            corporate: "Corporativa",
	    professional: "Profesional",
	    berlin: "Berlin"
        }
    },
    en: {
        appTitle: "Resume Builder Pro",
        appSubtitle: "Create your professional resume in minutes",
        personalInfoTitle: "Personal Information",
        nameLabel: "Full Name",
        emailLabel: "Email",
        phoneLabel: "Phone",
        locationLabel: "Location",
        summaryTitle: "Professional Summary",
        experienceTitle: "Work Experience",
        educationTitle: "Education",
        skillsTitle: "Skills",
	certificationsTitle: "Certifications & Training",
	volunteerTitle: "Volunteer & Internships",
        previewTitle: "Preview",
        addExperience: "+ Add Experience",
        addEducation: "+ Add Education",
        addSkill: "+ Add Category",
	addCertification: "+ Add Certification",
	addVolunteer: "+ Add Experience",
	certificationName: "Certification/Course",
	organization: "Organization",
	date: "Date",
	volunteerRole: "Role/Position",
	volunteerOrg: "Organization",
	volunteerDuration: "Duration",
	volunteerDescription: "Activity Description",
        position: "Position/Title",
        company: "Company",
        startDate: "Start Date",
        endDate: "End Date",
        current: "Current Job",
        tasks: "Tasks and Responsibilities",
        degree: "Degree/Title",
        institution: "Institution",
        year: "Year",
        description: "Description",
        skillCategory: "Category",
        skillName: "Skill",
        skillLevel: "Level",
        remove: "Remove",
        addSkillBtn: "+ Add Skill",
        levels: {
            beginner: "Beginner",
            intermediate: "Intermediate",
            advanced: "Advanced",
            expert: "Expert"
        },
        templates: {
            modern: "Modern",
            creative: "Creative",
            minimal: "Minimal",
            elegant: "Elegant",
            clean: "Clean",
            corporate: "Corporate",
	    professional: "Profesional",
	    berlin: "Berlin"
        }
    }
};

// Inicializar cuando se carga la p谩gina
window.addEventListener('load', function() {
    setupEvents();
    updatePreview();
});

function setupEvents() {
    // Cambio de idioma
    document.getElementById('language-select').onchange = function() {
        currentLang = this.value;
        updateLanguage();
        updateTemplateOptions();
        updatePreview();
    };

    // Cambio de plantilla
    document.getElementById('template-select').onchange = function() {
    document.getElementById('resume-preview').className = 'resume-preview template-' + this.value + ' ' + getCurrentFontClass() + ' ' + getCurrentFontSizeClass();
};

    // NUEVO: Cambio de fuente
    document.getElementById('font-select').onchange = function() {
        updateFontClass();
    };

    // Cambio de tama帽o de fuente
    document.getElementById('font-size-select').onchange = function() {
        updateFontSize();
    };

}

// NUEVA FUNCIN: Obtener clase de fuente actual
function getCurrentFontClass() {
    const fontSelect = document.getElementById('font-select');
    return 'font-' + fontSelect.value;
}

// NUEVA FUNCIN: Actualizar clase de fuente
function updateFontClass() {
    const previewElement = document.getElementById('resume-preview');
    const templateSelect = document.getElementById('template-select');
    const fontClass = getCurrentFontClass();
    const fontSizeClass = getCurrentFontSizeClass();
    
    // Mantener la clase de plantilla, fuente y tama帽o
    previewElement.className = 'resume-preview template-' + templateSelect.value + ' ' + fontClass + ' ' + fontSizeClass;
}

// Funci贸n para obtener clase de tama帽o actual
function getCurrentFontSizeClass() {
    const fontSizeSelect = document.getElementById('font-size-select');
    return 'font-size-' + fontSizeSelect.value;
}

// Funci贸n para actualizar tama帽o de fuente
function updateFontSize() {
    const previewElement = document.getElementById('resume-preview');
    const templateSelect = document.getElementById('template-select');
    const fontClass = getCurrentFontClass();
    const fontSizeClass = getCurrentFontSizeClass();
    
    // Mantener la clase de plantilla, fuente y a帽adir tama帽o
    previewElement.className = 'resume-preview template-' + templateSelect.value + ' ' + fontClass + ' ' + fontSizeClass;
}

function updateLanguage() {
    const t = texts[currentLang];
    
    document.getElementById('app-title').textContent = 'UAGM ' + t.appTitle;
    document.getElementById('app-subtitle').textContent = t.appSubtitle;
    document.getElementById('personal-info-title').textContent = t.personalInfoTitle;
    document.getElementById('name-label').textContent = t.nameLabel;
    document.getElementById('email-label').textContent = t.emailLabel;
    document.getElementById('phone-label').textContent = t.phoneLabel;
    document.getElementById('location-label').textContent = t.locationLabel;
    document.getElementById('summary-title').textContent = t.summaryTitle;
    document.getElementById('experience-title').textContent = t.experienceTitle;
    document.getElementById('education-title').textContent = t.educationTitle;
    document.getElementById('skills-title').textContent = t.skillsTitle;
    document.getElementById('preview-title').textContent = t.previewTitle;
    document.getElementById('add-experience-btn').textContent = t.addExperience;
    document.getElementById('add-education-btn').textContent = t.addEducation;
    document.getElementById('add-skill-btn').textContent = t.addSkill;
    document.getElementById('certifications-title').textContent = t.certificationsTitle;
    document.getElementById('volunteer-title').textContent = t.volunteerTitle;
    document.getElementById('add-certification-btn').textContent = t.addCertification;
    document.getElementById('add-volunteer-btn').textContent = t.addVolunteer;
    document.querySelector('button[onclick="clearAll()"]').textContent = currentLang === 'es' ? ' Reiniciar' : ' Reset';

    document.getElementById('preview-summary-title').textContent = t.summaryTitle;
    document.getElementById('preview-experience-title').textContent = t.experienceTitle;
    document.getElementById('preview-education-title').textContent = t.educationTitle;
    document.getElementById('preview-skills-title').textContent = t.skillsTitle;
    document.getElementById('preview-certifications-title').textContent = t.certificationsTitle;
    document.getElementById('preview-volunteer-title').textContent = t.volunteerTitle;
    document.getElementById('summary').placeholder = 
    currentLang === 'es'
    ? "Profesional comprometido, proactivo y orientado a resultados, con habilidades en comunicaci贸n, trabajo en equipo y resoluci贸n de problemas. Capacidad para adaptarse a distintos entornos laborales, aprender r谩pidamente y cumplir con metas establecidas."
    : "Committed, proactive, and results-oriented professional with strong communication, teamwork, and problem-solving skills. Able to adapt to different work environments, learn quickly, and meet established goals.";
}

function updateTemplateOptions() {
    const select = document.getElementById('template-select');
    const current = select.value;
    const t = texts[currentLang].templates;
    
    select.innerHTML = `
        <option value="modern">${t.modern}</option>
        <option value="creative">${t.creative}</option>
        <option value="minimal">${t.minimal}</option>
        <option value="elegant">${t.elegant}</option>
        <option value="clean">${t.clean}</option>
        <option value="corporate">${t.corporate}</option>
	<option value="professional">${t.professional}</option>
	<option value="berlin">${t.berlin}</option>
    `;
    select.value = current;
}

function addExperience() {
    const container = document.getElementById('experience-container');
    const t = texts[currentLang];
    const id = expCount++;
    
    const html = `
        <div class="dynamic-section" id="exp-${id}">
            <button class="btn btn-remove btn-small remove-btn" onclick="removeItem('exp-${id}')">
                ${t.remove}
            </button>
            <h4>${t.experienceTitle} ${id + 1}</h4>
            
            <div class="form-row">
                <div class="form-group">
                    <label>${t.position}</label>
                    <input type="text" class="exp-position" placeholder="Desarrollador Senior" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label>${t.company}</label>
                    <input type="text" class="exp-company" placeholder="Empresa XYZ" oninput="updatePreview()">
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label>${t.startDate}</label>
                    <input type="text" class="exp-start" placeholder="2020" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label>${t.endDate}</label>
                    <input type="text" class="exp-end" id="exp-end-${id}" placeholder="Presente" oninput="updatePreview()">
                </div>
            </div>
            
            <div class="form-group">
                <label>
                    <input type="checkbox" class="exp-current" id="exp-current-${id}" onchange="toggleCurrentJob(${id})">
                    ${t.current}
                </label>
            </div>
            
            <div class="form-group">
                <label>${t.tasks}</label>
                <textarea class="exp-tasks" placeholder=" Desarrollo de aplicaciones web" oninput="updatePreview()"></textarea>
            </div>
        </div>
    `;
    
    container.insertAdjacentHTML('beforeend', html);
    updatePreview();
}

function toggleCurrentJob(expId) {
    const checkbox = document.getElementById(`exp-current-${expId}`);
    const endDateInput = document.getElementById(`exp-end-${expId}`);
    
    if (checkbox.checked) {
        endDateInput.value = currentLang === 'es' ? 'Presente' : 'Present';
        endDateInput.disabled = true;
        endDateInput.style.backgroundColor = '#f5f5f5';
        endDateInput.style.color = '#666';
    } else {
        endDateInput.value = '';
        endDateInput.disabled = false;
        endDateInput.style.backgroundColor = '';
        endDateInput.style.color = '';
    }
    
    updatePreview();
}

function addEducation() {
    const container = document.getElementById('education-container');
    const t = texts[currentLang];
    const id = eduCount++;
    
    const html = `
        <div class="dynamic-section" id="edu-${id}">
            <button class="btn btn-remove btn-small remove-btn" onclick="removeItem('edu-${id}')">
                ${t.remove}
            </button>
            <h4>${t.educationTitle} ${id + 1}</h4>
            
            <div class="form-row">
                <div class="form-group">
                    <label>${t.degree}</label>
                    <input type="text" class="edu-degree" placeholder="Licenciatura en Ciencias" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label>${t.institution}</label>
                    <input type="text" class="edu-institution" placeholder="Universidad Nacional" oninput="updatePreview()">
                </div>
            </div>
            
            <div class="form-group">
                <label>${t.year}</label>
                <input type="text" class="edu-year" placeholder="2015-2019" oninput="updatePreview()">
            </div>
            
            <div class="form-group">
                <label>${t.description}</label>
                <textarea class="edu-description" placeholder="Descripci贸n adicional..." oninput="updatePreview()"></textarea>
            </div>
        </div>
    `;
    
    container.insertAdjacentHTML('beforeend', html);
    updatePreview();
}

function addSkillCategory() {
    const container = document.getElementById('skills-container');
    const t = texts[currentLang];
    const id = skillCount++;
    
    const html = `
        <div class="dynamic-section" id="skill-cat-${id}">
            <button class="btn btn-remove btn-small remove-btn" onclick="removeItem('skill-cat-${id}')">
                ${t.remove}
            </button>
            <h4>${t.skillsTitle} ${id + 1}</h4>
            
            <div class="form-group">
                <label>${t.skillCategory}</label>
                <select class="skill-category-name" onchange="updateSkillOptions(${id})" id="category-select-${id}">
                    <option value="">${currentLang === 'es' ? 'Seleccionar categor铆a' : 'Select category'}</option>
                    <option value="technical">${currentLang === 'es' ? 'Habilidades T茅cnicas' : 'Technical Skills'}</option>
                    <option value="soft">${currentLang === 'es' ? 'Habilidades Blandas' : 'Soft Skills'}</option>
                </select>
            </div>
            
            <div class="skill-selection-container" id="skill-selection-${id}" style="display: none;">
                <label>${currentLang === 'es' ? 'Seleccionar habilidades:' : 'Select skills:'}</label>
                <div class="skill-checkboxes" id="skill-checkboxes-${id}"></div>
                
                <!-- NUEVA SECCIN PARA HABILIDADES PERSONALIZADAS -->
                <div class="custom-skill-section">
                    <label>${currentLang === 'es' ? 'Agregar habilidad personalizada:' : 'Add custom skill:'}</label>
                    <div class="custom-skill-input-container">
                        <input 
                            type="text" 
                            id="custom-skill-input-${id}" 
                            placeholder="${currentLang === 'es' ? 'Escribir nueva habilidad...' : 'Write new skill...'}"
                            class="custom-skill-input"
                        >
                        <button 
                            type="button" 
                            class="btn btn-add btn-small" 
                            onclick="addCustomSkill(${id})"
                        >
                            ${currentLang === 'es' ? 'Agregar' : 'Add'}
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="selected-skills-display" id="selected-skills-${id}">
                <h5>${currentLang === 'es' ? 'Habilidades seleccionadas:' : 'Selected skills:'}</h5>
                <div class="skills-list" id="skills-list-${id}"></div>
            </div>
        </div>
    `;
    
    container.insertAdjacentHTML('beforeend', html);
    updatePreview();
}

function addCertification() {
    const container = document.getElementById('certifications-container');
    const t = texts[currentLang];
    const id = certCount++;
    
    const html = `
        <div class="dynamic-section" id="cert-${id}">
            <button class="btn btn-remove btn-small remove-btn" onclick="removeItem('cert-${id}')">
                ${t.remove}
            </button>
            <h4>${t.certificationsTitle} ${id + 1}</h4>
            
            <div class="form-row">
                <div class="form-group">
                    <label>${t.certificationName}</label>
                    <input type="text" class="cert-name" placeholder="AWS Cloud Practitioner" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label>${t.organization}</label>
                    <input type="text" class="cert-org" placeholder="Amazon Web Services" oninput="updatePreview()">
                </div>
            </div>
            
            <div class="form-group">
                <label>${t.date}</label>
                <input type="text" class="cert-date" placeholder="2023" oninput="updatePreview()">
            </div>
            
            <div class="form-group">
                <label>${t.description}</label>
                <textarea class="cert-description" placeholder="Descripci贸n de la certificaci贸n..." oninput="updatePreview()"></textarea>
            </div>
        </div>
    `;
    
    container.insertAdjacentHTML('beforeend', html);
    updatePreview();
}

function addVolunteer() {
    const container = document.getElementById('volunteer-container');
    const t = texts[currentLang];
    const id = volunteerCount++;
    
    const html = `
        <div class="dynamic-section" id="vol-${id}">
            <button class="btn btn-remove btn-small remove-btn" onclick="removeItem('vol-${id}')">
                ${t.remove}
            </button>
            <h4>${t.volunteerTitle} ${id + 1}</h4>
            
            <div class="form-row">
                <div class="form-group">
                    <label>${t.volunteerRole}</label>
                    <input type="text" class="vol-role" placeholder="Interno de Marketing / Voluntario" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label>${t.volunteerOrg}</label>
                    <input type="text" class="vol-org" placeholder="Empresa ABC / Cruz Roja" oninput="updatePreview()">
                </div>
            </div>
            
            <div class="form-group">
                <label>${t.volunteerDuration}</label>
                <input type="text" class="vol-duration" placeholder="2022 - 2023" oninput="updatePreview()">
            </div>
            
            <div class="form-group">
                <label>${t.volunteerDescription}</label>
               <textarea class="vol-description" placeholder="Descripci贸n de actividades realizadas..." oninput="updatePreview()">
                </textarea>
            </div>
        </div>
    `;
    
    container.insertAdjacentHTML('beforeend', html);
    updatePreview();
}

function addCustomSkill(categoryId) {
    const customInput = document.getElementById(`custom-skill-input-${categoryId}`);
    const skillValue = customInput.value.trim();
    
    if (skillValue) {
        // Crear un checkbox temporal para la habilidad personalizada
        const skillCheckboxes = document.getElementById(`skill-checkboxes-${categoryId}`);
        const customSkillId = `custom-skill-${categoryId}-${Date.now()}`;
        
        const customSkillHtml = `
            <div class="skill-checkbox-item custom-skill-item">
                <input type="checkbox" id="${customSkillId}" value="${skillValue}" checked onchange="updateSelectedSkills(${categoryId})">
                <label for="${customSkillId}">${skillValue}</label>
                <button type="button" class="btn btn-remove btn-small" onclick="removeCustomSkill('${customSkillId}', ${categoryId})" style="margin-left: auto;"></button>
            </div>
        `;
        
        skillCheckboxes.insertAdjacentHTML('beforeend', customSkillHtml);
        
        // Limpiar el input
        customInput.value = '';
        
        // Actualizar la vista previa
        updateSelectedSkills(categoryId);
    } else {
        alert(currentLang === 'es' ? 'Por favor escribe una habilidad' : 'Please write a skill');
    }
}

function removeCustomSkill(skillId, categoryId) {
    const skillElement = document.getElementById(skillId).closest('.skill-checkbox-item');
    if (skillElement) {
        skillElement.remove();
        updateSelectedSkills(categoryId);
    }
}

function updateSkillOptions(categoryId) {
    const categorySelect = document.getElementById(`category-select-${categoryId}`);
    const skillSelection = document.getElementById(`skill-selection-${categoryId}`);
    const skillCheckboxes = document.getElementById(`skill-checkboxes-${categoryId}`);
    
    const selectedCategory = categorySelect.value;
    
    if (selectedCategory) {
        skillSelection.style.display = 'block';
        skillCheckboxes.innerHTML = '';
        
        const skills = predefinedSkills[currentLang][selectedCategory];
        
        skills.forEach((skill, index) => {
            const checkboxId = `skill-${categoryId}-${index}`;
            const checkboxHtml = `
                <div class="skill-checkbox-item">
                    <input type="checkbox" id="${checkboxId}" value="${skill}" onchange="updateSelectedSkills(${categoryId})">
                    <label for="${checkboxId}">${skill}</label>
                </div>
            `;
            skillCheckboxes.insertAdjacentHTML('beforeend', checkboxHtml);
        });
    } else {
        skillSelection.style.display = 'none';
        document.getElementById(`skills-list-${categoryId}`).innerHTML = '';
        updatePreview();
    }
}

function updateSelectedSkills(categoryId) {
    const checkboxes = document.querySelectorAll(`#skill-checkboxes-${categoryId} input[type="checkbox"]:checked`);
    const skillsList = document.getElementById(`skills-list-${categoryId}`);
    
    skillsList.innerHTML = '';
    
    checkboxes.forEach(checkbox => {
        const skillTag = document.createElement('span');
        skillTag.className = 'skill-tag';
        skillTag.textContent = checkbox.value;
        skillsList.appendChild(skillTag);
    });
    
    updatePreview();
}

function addSkill(categoryId) {
    const container = document.getElementById(`skills-list-${categoryId}`);
    const t = texts[currentLang];
    const skillId = Date.now();
    
    const html = `
        <div class="skill-item" id="skill-${skillId}">
            <input type="text" class="skill-name" placeholder="${t.skillName}" oninput="updatePreview()">
            <select class="skill-level" oninput="updatePreview()">
                <option value="beginner">${t.levels.beginner}</option>
                <option value="intermediate">${t.levels.intermediate}</option>
                <option value="advanced">${t.levels.advanced}</option>
                <option value="expert">${t.levels.expert}</option>
            </select>
            <button class="btn btn-remove btn-small" onclick="removeItem('skill-${skillId}')">
                ${t.remove}
            </button>
        </div>
    `;
    
    container.insertAdjacentHTML('beforeend', html);
    updatePreview();
}

function removeItem(id) {
    const element = document.getElementById(id);
    if (element) {
        element.remove();
        updatePreview();
    }
}

function updatePreview() {
    // Informaci贸n personal
    document.getElementById('preview-name').textContent = 
        document.getElementById('name').value || (currentLang === 'es' ? 'Tu Nombre' : 'Your Name');
    document.getElementById('preview-email').textContent = 
        document.getElementById('email').value || 'email@ejemplo.com';
    document.getElementById('preview-phone').textContent = 
        document.getElementById('phone').value || '+1 234 567 8900';
    document.getElementById('preview-location').textContent = 
        document.getElementById('location').value || (currentLang === 'es' ? 'Ciudad, Pa铆s' : 'City, Country');
    
    // Resumen
    const summary = document.getElementById('summary').value;
    document.getElementById('preview-summary').innerHTML = 
        summary ? summary.replace(/\n/g, '<br>') : 
        (currentLang === 'es' ? 'Profesional comprometido, proactivo y orientado a resultados, con habilidades en comunicaci贸n, trabajo en equipo y resoluci贸n de problemas. Capacidad para adaptarse a distintos entornos laborales, 	aprender r谩pidamente y cumplir con metas establecidas.' : 'Committed, proactive, and results-oriented professional with strong communication, teamwork, and problem-solving skills. Able to adapt to different work environments, 	learn quickly, and meet established goals.');
    
    // Experiencias
updateExperiencePreview();
updateEducationPreview();
updateSkillsPreview();
updateCertificationsPreview();
updateVolunteerPreview();
}

function updateExperiencePreview() {
    const container = document.getElementById('preview-experience');
    let html = '';
    
    const experiences = document.querySelectorAll('#experience-container .dynamic-section');
    experiences.forEach((exp) => {
        const position = exp.querySelector('.exp-position')?.value || '';
        const company = exp.querySelector('.exp-company')?.value || '';
        const startDate = exp.querySelector('.exp-start')?.value || '';
        const endDate = exp.querySelector('.exp-end')?.value || '';
        const tasks = exp.querySelector('.exp-tasks')?.value || '';
        
        if (position || company) {
            html += `
                <div class="experience-item">
                    <div class="job-title">${position}</div>
                    <div class="company-info">${company} | ${startDate} - ${endDate}</div>
                    <div class="job-description">${tasks.replace(/\n/g, '<br>')}</div>
                </div>
            `;
        }
    });
    
    container.innerHTML = html || 
        (currentLang === 'es' ? 'Tu experiencia laboral aparecer谩 aqu铆...' : 'Your work experience will appear here...');
}

function updateEducationPreview() {
    const container = document.getElementById('preview-education');
    let html = '';
    
    const educations = document.querySelectorAll('#education-container .dynamic-section');
    educations.forEach((edu) => {
        const degree = edu.querySelector('.edu-degree')?.value || '';
        const institution = edu.querySelector('.edu-institution')?.value || '';
        const year = edu.querySelector('.edu-year')?.value || '';
        const description = edu.querySelector('.edu-description')?.value || '';
        
        if (degree || institution) {
            html += `
                <div class="education-item">
                    <div class="degree-title">${degree}</div>
                    <div class="institution-info">${institution} | ${year}</div>
                    ${description ? `<div>${description}</div>` : ''}
                </div>
            `;
        }
    });
    
    container.innerHTML = html || 
        (currentLang === 'es' ? 'Tu educaci贸n aparecer谩 aqu铆...' : 'Your education will appear here...');
}

function updateSkillsPreview() {
    const container = document.getElementById('preview-skills');
    let html = '';
    
    const skillCategories = document.querySelectorAll('#skills-container .dynamic-section');
    skillCategories.forEach((cat) => {
        const categorySelect = cat.querySelector('.skill-category-name');
        const categoryName = categorySelect ? categorySelect.selectedOptions[0]?.text : '';
        
        // Buscar las habilidades seleccionadas (checkboxes marcados)
        const selectedSkills = cat.querySelectorAll('.skill-checkboxes input[type="checkbox"]:checked');
        
        if (categoryName && categoryName !== (currentLang === 'es' ? 'Seleccionar categor铆a' : 'Select category') && selectedSkills.length > 0) {
            html += `<div class="skills-category">`;
            html += `<h4>${categoryName}</h4>`;
            html += `<div class="skills-list">`;
            
            selectedSkills.forEach((checkbox) => {
                const skillName = checkbox.value;
                if (skillName) {
                    html += `<span class="skill-tag">${skillName}</span>`;
                }
            });
            
            html += `</div></div>`;
        }
    });
    
    container.innerHTML = html || 
        (currentLang === 'es' ? 'Tus habilidades aparecer谩n aqu铆...' : 'Your skills will appear here...');
}

function updateCertificationsPreview() {
    const container = document.getElementById('preview-certifications');
    const section = container.closest('.resume-section');
    let html = '';
    
    const certifications = document.querySelectorAll('#certifications-container .dynamic-section');
    certifications.forEach((cert) => {
        const name = cert.querySelector('.cert-name')?.value || '';
        const org = cert.querySelector('.cert-org')?.value || '';
        const date = cert.querySelector('.cert-date')?.value || '';
        const description = cert.querySelector('.cert-description')?.value || '';
        
        if (name || org) {
            html += `
                <div class="education-item">
                    <div class="degree-title">${name}</div>
                    <div class="institution-info">${org} | ${date}</div>
                    ${description ? `<div>${description}</div>` : ''}
                </div>
            `;
        }
    });
    
    if (html) {
        container.innerHTML = html;
        section.style.display = 'block';
    } else {
        container.innerHTML = currentLang === 'es' ? 'Tus certificaciones aparecer谩n aqu铆...' : 'Your certifications will appear here...';
        section.style.display = 'none';
    }
}

function updateVolunteerPreview() {
    const container = document.getElementById('preview-volunteer');
    const section = container.closest('.resume-section');
    let html = '';
    
    const volunteers = document.querySelectorAll('#volunteer-container .dynamic-section');
    volunteers.forEach((vol) => {
        const role = vol.querySelector('.vol-role')?.value || '';
        const org = vol.querySelector('.vol-org')?.value || '';
        const duration = vol.querySelector('.vol-duration')?.value || '';
        const description = vol.querySelector('.vol-description')?.value || '';
        
        if (role || org) {
            html += `
                <div class="experience-item">
                    <div class="job-title">${role}</div>
                    <div class="company-info">${org} | ${duration}</div>
                    <div class="job-description">${description.replace(/\n/g, '<br>')}</div>
                </div>
            `;
        }
    });
    
    if (html) {
        container.innerHTML = html;
        section.style.display = 'block';
    } else {
        container.innerHTML = currentLang === 'es' ? 'Tu experiencia de voluntariado aparecer谩 aqu铆...' : 'Your volunteer experience will appear here...';
        section.style.display = 'none';
    }
 cleanPreviewFromModalContent();	

}
function clearAll() {
    if (confirm(currentLang === 'es' ? '驴Seguro que quieres limpiar todo?' : 'Are you sure you want to clear everything?')) {
        // Limpiar informaci贸n personal y resumen
        document.getElementById('name').value = '';
        document.getElementById('email').value = '';
        document.getElementById('phone').value = '';
        document.getElementById('location').value = '';
        document.getElementById('summary').value = '';
        
        // Limpiar completamente las secciones din谩micas
document.getElementById('experience-container').innerHTML = '';
document.getElementById('education-container').innerHTML = '';
document.getElementById('skills-container').innerHTML = '';
document.getElementById('certifications-container').innerHTML = '';
document.getElementById('volunteer-container').innerHTML = '';

// Resetear contadores
expCount = 0;
eduCount = 0;
skillCount = 0;
certCount = 0;
volunteerCount = 0;

	// Resetear todos los selectores a valores originales
	document.getElementById('language-select').value = 'es';
	document.getElementById('template-select').value = 'modern';
	document.getElementById('font-select').value = 'arial';
	document.getElementById('font-size-select').value = '14';

	// Actualizar el idioma y clases
	currentLang = 'es';
	updateLanguage();
	updateTemplateOptions();
	updateFontClass();
        
        // NO agregar elementos autom谩ticamente - dejar las secciones vac铆as
        // addExperience();     ELIMINAR O COMENTAR ESTAS LNEAS
        // addEducation();      ELIMINAR O COMENTAR ESTAS LNEAS  
        // addSkillCategory();  ELIMINAR O COMENTAR ESTAS LNEAS
        
        updatePreview();
    }
}

// Funciones de exportaci贸n
async function exportToPDF() {
    try {
        // Verificar si las librer铆as est谩n cargadas
        if (typeof window.jspdf === 'undefined' || typeof html2canvas === 'undefined') {
            alert('Las librer铆as de PDF no est谩n cargadas. Por favor recarga la p谩gina.');
            return;
        }

        const { jsPDF } = window.jspdf;
        const element = document.getElementById('resume-preview');
        
        // Configuraciones mejoradas para html2canvas
        const canvas = await html2canvas(element, {
            scale: 2,
            useCORS: true,
            logging: false,
            backgroundColor: '#ffffff',
            height: element.scrollHeight,
            windowWidth: element.scrollWidth,
            allowTaint: true,
            removeContainer: true,
            imageTimeout: 0,
            onclone: function(clonedDoc) {
                // Ajustar estilos en el clon para mejor rendering
                const clonedElement = clonedDoc.getElementById('resume-preview');
                if (clonedElement) {
                    clonedElement.style.width = '800px';
                    clonedElement.style.padding = '40px';
                    clonedElement.style.boxSizing = 'border-box';
                    clonedElement.style.fontSize = '14px';
                    clonedElement.style.lineHeight = '1.4';
                    
                    // Prevenir que elementos se corten
                    const sections = clonedElement.querySelectorAll('.resume-section, .experience-item, .education-item');
                    sections.forEach(section => {
                        section.style.breakInside = 'avoid';
                        section.style.pageBreakInside = 'avoid';
                    });
                }
            }
        });
        
        const imgData = canvas.toDataURL('image/png', 1.0);
        
        // Configuraci贸n del PDF
        const pdf = new jsPDF({
            orientation: 'portrait',
            unit: 'mm',
            format: 'a4',
            compress: true
        });
        
        const pdfWidth = 210; // A4 width in mm
        const pdfHeight = 297; // A4 height in mm
        const margin = 10; // Margen de 10mm
        const contentWidth = pdfWidth - (margin * 2);
        const contentHeight = pdfHeight - (margin * 2);
        
        // Calcular dimensiones de la imagen
        const imgWidth = contentWidth;
        const imgHeight = (canvas.height * imgWidth) / canvas.width;
        
        // Si la imagen cabe en una p谩gina
        if (imgHeight <= contentHeight) {
            pdf.addImage(imgData, 'PNG', margin, margin, imgWidth, imgHeight);
        } else {
            // Si necesita m煤ltiples p谩ginas, dividir inteligentemente
            const totalPages = Math.ceil(imgHeight / contentHeight);
            
            for (let page = 0; page < totalPages; page++) {
                if (page > 0) {
                    pdf.addPage();
                }
                
                const yOffset = -(page * contentHeight);
                const remainingHeight = imgHeight - (page * contentHeight);
                const currentPageHeight = Math.min(contentHeight, remainingHeight);
                
                // Crear un canvas temporal para esta p谩gina
                const pageCanvas = document.createElement('canvas');
                const pageCtx = pageCanvas.getContext('2d');
                
                pageCanvas.width = canvas.width;
                pageCanvas.height = (currentPageHeight * canvas.width) / imgWidth;
                
                // Copiar la porci贸n correspondiente de la imagen original
                pageCtx.drawImage(
                    canvas,
                    0, (page * contentHeight * canvas.width) / imgWidth,
                    canvas.width, pageCanvas.height,
                    0, 0,
                    canvas.width, pageCanvas.height
                );
                
                const pageImgData = pageCanvas.toDataURL('image/png', 1.0);
                pdf.addImage(pageImgData, 'PNG', margin, margin, imgWidth, currentPageHeight);
            }
        }
        
        // Guardar el PDF
        const fileName = document.getElementById('name').value || 'resume';
        pdf.save(`${fileName}_resume.pdf`);

// MOSTRAR MENSAJE INFORMATIVO
showCareerOfficeInfo();

    } catch (error) {
        console.error('Error generando PDF:', error);
        alert('Error al generar el PDF. Intenta de nuevo.');
    }
}

function exportToWord() {
    try {
        // Mostrar advertencia sobre limitaciones de Word
        const confirmExport = confirm(
            currentLang === 'es' 
            ? '锔 AVISO IMPORTANTE:\n\nAl exportar a Word, algunas plantillas pueden afectarse debido a las limitaciones del formato.\n\nPara mejores resultados, recomendamos usar la exportaci贸n PDF.\n\n驴Deseas continuar con la exportaci贸n a Word?'
            : '锔 IMPORTANT NOTICE:\n\nWhen exporting to Word, some templates may be affected due to format limitations.\n\nFor best results, we recommend using PDF export.\n\nDo you want to continue with Word export?'
        );
        
        if (!confirmExport) {
            return; // Si cancela, no exporta
        }

        const previewContent = document.getElementById('resume-preview').innerHTML;
        const template = document.getElementById('template-select').value;
        
       // Mapeo de fuentes
const fontMap = {
    'arial': 'Arial, sans-serif',
    'times': '"Times New Roman", serif',
    'helvetica': '"Inter", "Helvetica Neue", Helvetica, Arial, sans-serif',
    'georgia': 'Georgia, serif',
    'calibri': 'Calibri, Arial, sans-serif',
    'verdana': 'Verdana, Arial, sans-serif',
    'tahoma': 'Tahoma, Arial, sans-serif',
    'trebuchet': '"Trebuchet MS", Arial, sans-serif',
    'roboto': '"Roboto", Arial, sans-serif',
    'opensans': '"Open Sans", Arial, sans-serif',
    'lato': '"Lato", Arial, sans-serif',
    'montserrat': '"Montserrat", Arial, sans-serif',
    'poppins': '"Poppins", Arial, sans-serif',
    'playfair': '"Playfair Display", Georgia, serif',
    'merriweather': '"Merriweather", Georgia, serif',
    'source-sans': '"Source Sans Pro", Arial, sans-serif'
};

const selectedFont = document.getElementById('font-select').value;

let styles = `
    <style>
        body { 
            font-family: ${fontMap[selectedFont]}
                    margin: 40px; 
                    line-height: 1.6; 
                    color: #333;
                }
                .resume-header { margin-bottom: 30px; }
                .name { margin-bottom: 10px; }
                .contact-info { margin-bottom: 20px; }
                .resume-section { margin-bottom: 20px; }
                .experience-item, .education-item { 
                    margin-bottom: 15px; 
                    padding-bottom: 10px; 
                    border-bottom: 1px solid #e2e8f0; 
                }
                .job-title, .degree-title { 
                    font-weight: bold; 
                    font-size: 16px; 
                    color: #2d3748; 
                }
                .company-info, .institution-info { 
                    color: #718096; 
                    font-size: 14px; 
                    margin-bottom: 5px; 
                }
                .skills-category { margin-bottom: 15px; }
                .skills-category h4 { 
                    font-weight: bold; 
                    margin-bottom: 8px; 
                    color: #2d3748; 
                }
                .skills-list { 
                    display: flex; 
                    flex-wrap: wrap; 
                    gap: 8px; 
                }
                .skill-tag { 
                    color: white; 
                    padding: 4px 8px; 
                    border-radius: 12px; 
                    font-size: 12px; 
                    font-weight: 500; 
                    display: inline-block;
                }
        `;

        // Estilos espec铆ficos por plantilla
        switch(template) {
            case 'modern':
                styles += `
                    .name {
                        font-size: 32px;
                        color: #2d3748;
                        font-weight: bold;
                    }
                    .resume-header {
                        border-bottom: 3px solid #667eea;
                        padding-bottom: 20px;
                    }
                    .contact-info {
                        font-size: 14px;
                        color: #718096;
                    }
                    h3 {
                        color: #2d3748;
                        border-bottom: 2px solid #667eea;
                        padding-bottom: 5px;
                        margin-bottom: 15px;
                        font-size: 18px;
                    }
                    .skill-tag { background: #667eea; }
                `;
                break;
                
            case 'creative':
                styles += `
                    .resume-header {
                        background-color: #667eea !important;
                        background: #667eea !important;
                        color: white;
                        padding: 30px;
                        text-align: center;
                        margin: -40px -40px 30px -40px;
                    }
                    .name {
                        font-size: 32px;
                        font-weight: bold;
                        color: white !important;
                    }
                    .contact-info {
                        font-size: 14px;
                        color: white !important;
                    }
                    h3 {
                        color: #667eea;
                        border-bottom: 2px solid #667eea;
                        padding-bottom: 5px;
                        margin-bottom: 15px;
                        font-size: 18px;
                    }
                    .skill-tag { background: #667eea; }
                `;
                break;
                
            case 'minimal':
                styles += `
                    .resume-header {
                        text-align: center;
                        border-bottom: 1px solid #e2e8f0;
                        padding-bottom: 20px;
                    }
                    .name {
                        font-size: 28px;
                        font-weight: 300;
                        letter-spacing: 2px;
                        text-transform: uppercase;
                        color: #2d3748;
                    }
                    .contact-info {
                        font-size: 14px;
                        color: #718096;
                        font-weight: 300;
                    }
                    h3 {
                        color: #2d3748;
                        border-bottom: 1px solid #e2e8f0;
                        padding-bottom: 5px;
                        margin-bottom: 15px;
                        font-size: 16px;
                        font-weight: 400;
                        text-transform: uppercase;
                        letter-spacing: 1px;
                    }
                    .skill-tag { background: #667eea; }
                `;
                break;
                
            case 'elegant':
                styles += `
                    .resume-header {
                        background-color: #1a202c !important;
                        background: #1a202c !important;
                        color: white;
                        padding: 30px;
                        text-align: center;
                        margin: -40px -40px 30px -40px;
                    }
                    .name {
                        font-size: 32px;
                        font-weight: bold;
                        color: white !important;
                        font-family: 'Georgia', serif;
                    }
                    .contact-info {
                        font-size: 14px;
                        color: white !important;
                        font-style: italic;
                    }
                    h3 {
                        color: #1a202c;
                        border-bottom: 2px solid #1a202c;
                        padding-bottom: 5px;
                        margin-bottom: 15px;
                        font-size: 18px;
                        font-family: 'Georgia', serif;
                    }
                    .skill-tag { background: #1a202c; }
                `;
                break;
                
            case 'clean':
                styles += `
                    .resume-header {
                        border-bottom: 3px solid #48bb78;
                        padding-bottom: 20px;
                    }
                    .name {
                        color: #2f855a;
                        font-size: 30px;
                        font-weight: bold;
                    }
                    .contact-info {
                        font-size: 14px;
                        color: #68d391;
                    }
                    h3 {
                        color: #2f855a;
                        border-bottom: 2px solid #48bb78;
                        padding-bottom: 5px;
                        margin-bottom: 15px;
                        font-size: 18px;
                    }
                    .skill-tag { background: #48bb78; }
                `;
                break;
                
            case 'corporate':
                styles += `
                    .resume-header {
                        background-color: #2b6cb0 !important;
                        background: #2b6cb0 !important;
                        color: white;
                        padding: 25px;
                        margin: -40px -40px 30px -40px;
                    }
                    .name {
                        font-size: 30px;
                        font-weight: bold;
                        color: white !important;
                    }
                    .contact-info {
                        font-size: 14px;
                        color: white !important;
                    }
                    h3 {
                        color: #2b6cb0;
                        border-bottom: 2px solid #2b6cb0;
                        padding-bottom: 5px;
                        margin-bottom: 15px;
                        font-size: 18px;
                        font-weight: bold;
                    }
                    .skill-tag { background: #2b6cb0; }
                `;
                break;
 case 'professional':
                styles += `
                    body {
                        display: grid;
                        grid-template-columns: 300px 1fr;
                        gap: 30px;
                    }
                    .resume-header {
                        grid-column: 1 / -1;
                        border-bottom: 3px solid #2d3748;
                        padding-bottom: 20px;
                        margin-bottom: 30px;
                        position: relative;
                    }
                    .name {
                        font-size: 32px;
                        font-weight: bold;
                        color: #2d3748;
                        text-transform: uppercase;
                        letter-spacing: 1px;
                    }
                    .contact-info {
                        position: absolute;
                        right: 0;
                        top: 0;
                        text-align: right;
                        font-size: 14px;
                        color: #4a5568;
                    }
                    .resume-summary {
                        grid-column: 1 / -1;
                        text-align: center;
                        margin-bottom: 30px;
                        padding: 20px;
                        background: #f7fafc;
                    }
                    .left-column { grid-column: 1; }
                    .right-column { grid-column: 2; }
                    h3 {
                        color: #2d3748;
                        font-size: 18px;
                        text-transform: uppercase;
                        letter-spacing: 1px;
                        border-bottom: 2px solid #2d3748;
                        padding-bottom: 8px;
                        margin-bottom: 20px;
                    }
                    .skill-tag { background: #2d3748; }
                `;
                break;

        }

        styles += '</style>';

        const html = `
            <html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40">
            <head>
                <meta charset="utf-8">
                <title>Resume</title>
                ${styles}
            </head>
            <body>
                ${previewContent}
            </body>
            </html>
        `;

        const blob = new Blob(['\ufeff', html], { 
            type: 'application/msword' 
        });
        
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        const fileName = document.getElementById('name').value || 'resume';
        a.href = url;
        a.download = `${fileName}_resume.doc`;
        document.body.appendChild(a);
        a.click();
        
document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        // AGREGAR ESTAS LNEAS:
        // MOSTRAR MENSAJE INFORMATIVO  
showCareerOfficeWordInfo();
        
    } catch (error) {
        console.error('Error al exportar Word:', error);
        alert('Error al exportar a Word');
    }      
}

function cleanPreviewFromModalContent() {
    const resumePreview = document.getElementById('resume-preview');
    // Eliminar cualquier contenido del modal que aparezca en la vista previa
    const modalSelectors = [
        '[id*="email-modal"]',
        '[id*="recipient-"]', 
        '[id*="subject-"]',
        '[id*="message-"]',
        '.email-modal-header',
        '.email-modal-body',
        '.email-modal-content'
    ];
    
    modalSelectors.forEach(selector => {
        const elements = resumePreview.querySelectorAll(selector);
        elements.forEach(el => el.remove());
    });
}

function openExitModal() {
    showFinalExitModal();
}

function closeExitModal() {
    document.getElementById('exit-modal').style.display = 'none';
}

function showFinalExitModal() {
    const modal = document.getElementById('exit-modal');
    if (modal) {
        modal.style.display = 'flex';
        modal.style.position = 'fixed';
        modal.style.top = '0';
        modal.style.left = '0';
        modal.style.width = '100%';
        modal.style.height = '100%';
        modal.style.zIndex = '99999';
        modal.style.backgroundColor = 'rgba(0,0,0,0.5)';
        modal.style.justifyContent = 'center';
        modal.style.alignItems = 'center';
    }
}

function updateExitModalTexts() {
    if (currentLang === 'es') {
        document.getElementById('exit-modal-title').textContent = '隆Gracias por usar UAGM Resume Builder!';
        // No intentar cambiar el p谩rrafo que no existe - ya est谩 bien en el HTML
    } else {
        document.getElementById('exit-modal-title').textContent = 'Thank you for using UAGM Resume Builder!';
        // No intentar cambiar el p谩rrafo que no existe - ya est谩 bien en el HTML
    }
}
function showSurveyModal() {
    updateSurveyTexts();
    document.getElementById('survey-modal').style.display = 'flex';
}

function closeSurveyModal() {
    document.getElementById('survey-modal').style.display = 'none';
}

function showSuccessAndSurvey(exportType) {
    const message = currentLang === 'es' 
        ? `隆Genial! Tu resum茅 en ${exportType} est谩 listo. \n\n驴Podr铆as ayudarnos con una encuesta r谩pida sobre tu experiencia?` 
        : `Great! Your ${exportType} resume is ready! \n\nCould you help us with a quick survey about your experience?`;
    
    if (confirm(message)) {
        showSurveyModal();
    }
}

async function submitSurveyAndExit() {
    try {
        // Recopilar datos
        const surveyData = collectSurveyData();
        
        // Preparar datos para Google Forms
        const formData = new FormData();
        formData.append('entry.278011305', surveyData.responses.resumePreparation || '');
        formData.append('entry.652553867', surveyData.responses.universitySupport || '');
        formData.append('entry.1508588457', surveyData.responses.difficultyResolution || '');
        formData.append('entry.989837215', surveyData.responses.easeOfUse || '');
        formData.append('entry.881790119', surveyData.responses.comments || '');
        
        // Enviar a Google Forms
        await fetch('https://docs.google.com/forms/d/e/1FAIpQLSddZXMDD3Jeb-Ra5kI9-xFGpepV2rumpTiZtWZSaCrC77a-tw/formResponse', {
            method: 'POST',
            body: formData,
            mode: 'no-cors'
        });
        
        // Mostrar mensaje de 茅xito
        alert(currentLang === 'es' 
            ? '隆Gracias por tu feedback! Tu opini贸n ha sido registrada exitosamente.' 
            : 'Thank you for your feedback! Your opinion has been successfully recorded.');
        
    } catch (error) {
        console.error('Error enviando encuesta:', error);
        alert(currentLang === 'es' 
            ? '隆Gracias por tu feedback! (Los datos se guardaron localmente)' 
            : 'Thank you for your feedback! (Data saved locally)');
    }
    
    closeSurveyModal();
}

function collectSurveyData() {
    const data = {
        timestamp: new Date().toISOString(),
        language: currentLang,
        responses: {}
    };
    
    // Recopilar respuesta pregunta 1
    const q1Radio = document.querySelector('input[name="q1-satisfaction"]:checked');
    if (q1Radio) {
        switch(q1Radio.value) {
            case 'muy-satisfecho': data.responses.resumePreparation = 'Muy Satisfecho'; break;
            case 'satisfecho': data.responses.resumePreparation = 'Satisfecho'; break;
            case 'neutral': data.responses.resumePreparation = 'Neutral'; break;
            case 'poco-satisfecho': data.responses.resumePreparation = 'Poco Satisfecho'; break;
        }
    }
    
    // Recopilar respuesta pregunta 2
    const q2Radio = document.querySelector('input[name="q2-effectiveness"]:checked');
    if (q2Radio) {
        switch(q2Radio.value) {
            case 'muy-satisfecho': data.responses.universitySupport = 'Muy Satisfecho'; break;
            case 'satisfecho': data.responses.universitySupport = 'Satisfecho'; break;
            case 'neutral': data.responses.universitySupport = 'Neutral'; break;
            case 'poco-satisfecho': data.responses.universitySupport = 'Poco Satisfecho'; break;
        }
    }
    
    // Recopilar respuesta pregunta 3
    const q3Radio = document.querySelector('input[name="q3-usefulness"]:checked');
    if (q3Radio) {
        switch(q3Radio.value) {
            case 'muy-satisfecho': data.responses.difficultyResolution = 'Muy Satisfecho'; break;
            case 'satisfecho': data.responses.difficultyResolution = 'Satisfecho'; break;
            case 'neutral': data.responses.difficultyResolution = 'Neutral'; break;
            case 'poco-satisfecho': data.responses.difficultyResolution = 'Poco Satisfecho'; break;
        }
    }
    
    // Recopilar respuesta pregunta 4
    const q4Radio = document.querySelector('input[name="q4-usability"]:checked');
    if (q4Radio) {
        switch(q4Radio.value) {
            case 'muy-satisfecho': data.responses.easeOfUse = 'Muy Satisfecho'; break;
            case 'satisfecho': data.responses.easeOfUse = 'Satisfecho'; break;
            case 'neutral': data.responses.easeOfUse = 'Neutral'; break;
            case 'poco-satisfecho': data.responses.easeOfUse = 'Poco Satisfecho'; break;
        }
    }
    
    // Recopilar comentarios
    data.responses.comments = document.getElementById('survey-comments').value;
    
    return data;
}

function setStarRating(rating) {
    const stars = document.querySelectorAll('.star');
    stars.forEach((star, index) => {
        if (index < rating) {
            star.classList.add('active');
        } else {
            star.classList.remove('active');
        }
        star.dataset.rating = rating;
    });
}

function setScaleRating(value, element) {
    // Remover selecci贸n anterior
    document.querySelectorAll('.scale-option').forEach(opt => {
        opt.classList.remove('selected');
    });
    // Agregar selecci贸n actual
    element.classList.add('selected');
}

function updateSurveyTexts() {
    const surveyTexts = {
        es: {
            title: ' Encuesta de Satisfacci贸n',
            subtitle: 'Tu opini贸n nos ayuda a mejorar',
            q1: '驴Qu茅 tan satisfecho est谩s en c贸mo esta aplicaci贸n prepar贸 tu resum茅?',
            q2: '驴Qu茅 tan efectiva consideras esta herramienta como apoyo de la universidad para tu inserci贸n laboral?',
            q3: '驴Qu茅 tan 煤til fue esta aplicaci贸n para superar dificultades en la creaci贸n de tu resum茅 profesional?',
            q4: '驴Qu茅 tan satisfecho est谩s con la facilidad de uso de la aplicaci贸n?',
            q5: 'Comentarios adicionales o sugerencias:',
            submitBtn: 'Enviar Encuesta y Salir',
            skipBtn: 'Omitir y Salir',
            options: {
                muy: 'Muy Satisfecho',
                satisfecho: 'Satisfecho',
                neutral: 'Neutral',
                poco: 'Poco Satisfecho'
            }
        },
        en: {
            title: ' Satisfaction Survey',
            subtitle: 'Your opinion helps us improve',
            q1: 'How satisfied are you with how this application prepared your resume?',
            q2: 'How effective do you consider this tool as university support for your job placement?',
            q3: 'How useful was this application to overcome difficulties in creating your professional resume?',
            q4: 'How satisfied are you with the ease of use of the application?',
            q5: 'Additional comments or suggestions:',
            submitBtn: 'Submit Survey and Exit',
            skipBtn: 'Skip and Exit',
            options: {
                muy: 'Very Satisfied',
                satisfecho: 'Satisfied',
                neutral: 'Neutral',
                poco: 'Not Very Satisfied'
            }
        }
    };
    
    const texts = surveyTexts[currentLang];
    
    document.getElementById('survey-title').textContent = texts.title;
    document.getElementById('survey-subtitle').textContent = texts.subtitle;
    document.getElementById('survey-q1').textContent = texts.q1;
    document.getElementById('survey-q2').textContent = texts.q2;
    document.getElementById('survey-q3').textContent = texts.q3;
    document.getElementById('survey-q4').textContent = texts.q4;
    document.getElementById('survey-q5').textContent = texts.q5;
    
    // Actualizar opciones para todas las preguntas
    ['q1', 'q2', 'q3', 'q4'].forEach(q => {
        document.getElementById(`${q}-muy`).textContent = texts.options.muy;
        document.getElementById(`${q}-satisfecho`).textContent = texts.options.satisfecho;
        document.getElementById(`${q}-neutral`).textContent = texts.options.neutral;
        document.getElementById(`${q}-poco`).textContent = texts.options.poco;
    });
    
   // Actualizar bot贸n
document.getElementById('survey-submit-btn').textContent = texts.submitBtn;
}

function closeApplication() {
    window.close();
    // Si no funciona window.close(), redirigir a una p谩gina en blanco
    if (!window.closed) {
        window.location.href = 'about:blank';
    }

}

function showCareerOfficeInfo() {
    const message = currentLang === 'es' 
        ? ` 隆Tu resum茅 PDF est谩 listo!\n\n 驴Te interesa compartir tu resum茅 con la Oficina de Carreras y Colocaciones?\n\nPuedes enviarlo directamente a:\n brgonzalez@uagm.edu\n\nLa Oficina de Carreras te puede ayudar con:\n Revisi贸n y mejoras de tu resum茅\n Oportunidades laborales\n Consejos de entrevistas\n Networking profesional\n\n隆No dudes en contactarnos!`
        : ` Your PDF resume is ready!\n\n Would you like to share your resume with the Career Services Office?\n\nYou can send it directly to:\n brgonzalez@uagm.edu\n\nCareer Services can help you with:\n Resume review and improvements\n Job opportunities\n Interview tips\n Professional networking\n\nDon't hesitate to contact us!`;
    
    alert(message);
    
    setTimeout(() => {
        showSuccessAndSurvey('PDF');
    }, 500);
}

function showCareerOfficeWordInfo() {
    const message = currentLang === 'es' 
        ? ` 隆Tu resum茅 Word est谩 listo!\n\n 驴Te interesa compartir tu resum茅 con la Oficina de Carreras y Colocaciones?\n\nPuedes enviarlo directamente a:\n brgonzalez@uagm.edu\n\nLa Oficina de Carreras te puede ayudar con:\n Revisi贸n y mejoras de tu resum茅\n Oportunidades laborales\n Consejos de entrevistas\n Networking profesional\n\n隆No dudes en contactarnos!`
        : ` Your Word resume is ready!\n\n Would you like to share your resume with the Career Services Office?\n\nYou can send it directly to:\n brgonzalez@uagm.edu\n\nCareer Services can help you with:\n Resume review and improvements\n Job opportunities\n Interview tips\n Professional networking\n\nDon't hesitate to contact us!`;
    
    alert(message);
    
    setTimeout(() => {
        showSuccessAndSurvey('Word');
    }, 500);
}

function openProfessionalCoverLetter() {
    updateProfessionalLetterTexts();
    fillResumeDataToLetter();
    updateLetterPreview();
    document.getElementById('professional-letter-modal').style.display = 'flex';
}

function closeProfessionalLetter() {
    document.getElementById('professional-letter-modal').style.display = 'none';
}

function toggleResumeData() {
    const useData = document.getElementById('use-resume-data').checked;
    if (useData) {
        fillResumeDataToLetter();
    }
    updateLetterPreview();
}

function fillResumeDataToLetter() {
    const useData = document.getElementById('use-resume-data').checked;
    
    if (useData) {
        document.getElementById('sender-name').value = document.getElementById('name').value || '';
        document.getElementById('sender-address').value = document.getElementById('location').value || '';
        document.getElementById('sender-phone').value = document.getElementById('phone').value || '';
        document.getElementById('sender-email').value = document.getElementById('email').value || '';
    }
}

function updateProfessionalLetterTexts() {
    if (currentLang === 'es') {
        document.getElementById('prof-letter-title').textContent = ' Carta de Presentaci贸n Profesional';
        document.getElementById('prof-letter-subtitle').textContent = 'Formato basado en est谩ndares profesionales';
        document.getElementById('sender-info-title').textContent = 'Tu Informaci贸n';
        document.getElementById('use-resume-label').textContent = 'Usar datos del resum茅';
        document.getElementById('sender-name-label').textContent = 'Nombre Completo:';
        document.getElementById('sender-address-label').textContent = 'Direcci贸n:';
        document.getElementById('sender-phone-label').textContent = 'Tel茅fono:';
        document.getElementById('sender-email-label').textContent = 'Email:';
        document.getElementById('company-info-title').textContent = 'Informaci贸n de la Empresa';
        document.getElementById('company-name-label').textContent = 'Nombre de la Empresa:';
        document.getElementById('company-address-label').textContent = 'Direcci贸n de la Empresa:';
        document.getElementById('department-label').textContent = 'Departamento/rea:';
        document.getElementById('position-info-title').textContent = 'Informaci贸n del Puesto';
        document.getElementById('position-title-label').textContent = 'T铆tulo del Puesto:';
        document.getElementById('job-source-label').textContent = 'Donde viste la oferta:';
        document.getElementById('content-title').textContent = 'Contenido Personalizado';
        document.getElementById('expertise-area-label').textContent = 'Tu 谩rea de expertise:';
        document.getElementById('additional-info-label').textContent = 'Informaci贸n adicional (opcional):';
        document.getElementById('prof-download-pdf').textContent = ' Descargar PDF';
        document.getElementById('prof-download-word').textContent = ' Descargar Word';
        document.getElementById('prof-close').textContent = 'Cerrar';
    }
}

function updateLetterPreview() {
    const senderName = document.getElementById('sender-name').value || '[Tu Nombre]';
    const senderAddress = document.getElementById('sender-address').value || '[Tu Direcci贸n]';
    const senderPhone = document.getElementById('sender-phone').value || '[Tu Tel茅fono]';
    const senderEmail = document.getElementById('sender-email').value || '[Tu Email]';
    
    const companyName = document.getElementById('company-name').value || '[Nombre de la Empresa]';
    const companyAddress = document.getElementById('company-address').value || '[Direcci贸n de la Empresa]';
    const department = document.getElementById('department').value || '[Departamento]';
    
    const positionTitle = document.getElementById('position-title').value || '[T铆tulo del Puesto]';
    const jobSource = document.getElementById('job-source').value || '[donde viste la oferta]';
    const expertiseArea = document.getElementById('expertise-area').value || '[tu 谩rea de expertise]';
    const additionalInfo = document.getElementById('additional-info').value || '';
    
    // Fecha actual
    const today = new Date();
    const dateString = today.toLocaleDateString('es-ES', {
        year: 'numeric',
        month: 'long',
        day: 'numeric'
    });
    
    // Generar contenido de la carta basado en tu formato
    const letterHTML = `
        <div style="margin-bottom: 30px;">
            <div style="font-weight: bold; font-size: 14pt; margin-bottom: 5px;">${senderName}</div>
            <div style="margin-bottom: 3px;">${senderAddress}</div>
            <div style="margin-bottom: 3px;">${senderPhone}</div>
            <div style="margin-bottom: 20px;">${senderEmail}</div>
        </div>

        <div style="margin-bottom: 30px;">
            <div style="margin-bottom: 20px;">${dateString}</div>
        </div>

        <div style="margin-bottom: 30px;">
            <div style="font-weight: bold; margin-bottom: 5px;">${companyName}</div>
            <div style="white-space: pre-line; margin-bottom: 15px;">${companyAddress}</div>
            <div style="margin-bottom: 20px;"><strong>${department}:</strong></div>
        </div>

        <div style="margin-bottom: 20px;">
            Con referencia al puesto de <strong>${positionTitle}</strong>, publicado en ${jobSource}; adjunto para su consideraci贸n mi resum茅 con las habilidades y experiencias que se relacionan con el puesto.
        </div>

        <div style="margin-bottom: 20px;">
            Considero que mi preparaci贸n profesional, as铆 como mi desarrollo en el 谩rea de ${expertiseArea} me capacita como candidato id贸neo para realizar con eficiencia las responsabilidades que conlleva la posici贸n solicitada. Estoy interesado(a) en formar parte de su organizaci贸n para contribuir al logro de objetivos que redunden en el crecimiento de la empresa.
        </div>

        ${additionalInfo ? `<div style="margin-bottom: 20px;">${additionalInfo}</div>` : ''}

        <div style="margin-bottom: 20px;">
            Agradecer铆a la oportunidad de entrevistarme, para ampliar la informaci贸n que estime necesaria.
        </div>

        <div style="margin-bottom: 40px;">
            Gracias por la atenci贸n prestada.
        </div>

        <div>
            <div style="margin-bottom: 40px;">Atentamente,</div>
            <div style="font-weight: bold;">${senderName}</div>
        </div>
    `;
    
    document.getElementById('letter-preview').innerHTML = letterHTML;
}

function downloadProfessionalLetter(format) {
    // Validar que hay contenido
    const senderName = document.getElementById('sender-name').value;
    const companyName = document.getElementById('company-name').value;
    
    if (!senderName || !companyName) {
        alert(currentLang === 'es' ? 
            'Por favor completa al menos tu nombre y el nombre de la empresa.' : 
            'Please fill in at least your name and company name.');
        return;
    }
    
    const filename = `${senderName.replace(/\s+/g, '_')}_carta_presentacion`;
    
    if (format === 'pdf') {
        downloadLetterAsPDF(filename);
    } else {
        downloadLetterAsWord(filename);
    }
    
    // Mostrar mensaje sobre env铆o a oficina de carreras
    setTimeout(() => {
        const message = currentLang === 'es' 
            ? ` 隆Tu carta de presentaci贸n est谩 lista!\n\n 驴Te interesa enviar tu carta junto con tu resum茅 a la Oficina de Carreras y Colocaciones?\n\nPuedes enviarlos a:\nbrgonzalez@uagm.edu\n\n隆Te pueden ayudar a mejorar ambos documentos!`
            : ` Your cover letter is ready!\n\n Would you like to send your letter along with your resume to the Career Services Office?\n\nYou can send them to:\nbrgonzalez@uagm.edu\n\nThey can help you improve both documents!`;
        
        alert(message);
    }, 1000);
}

function downloadLetterAsPDF(filename) {
    try {
        const { jsPDF } = window.jspdf;
        const letterContent = document.getElementById('letter-preview');
        
        const pdf = new jsPDF('portrait', 'mm', 'a4');
        pdf.setFont('times', 'normal');
        pdf.setFontSize(12);
        
        // Obtener el texto plano de la carta
        const textContent = letterContent.innerText || letterContent.textContent;
        const lines = textContent.split('\n').filter(line => line.trim() !== '');
        
        let yPosition = 20;
        const lineHeight = 6;
        const pageHeight = 280;
        
        lines.forEach((line, index) => {
            if (yPosition > pageHeight) {
                pdf.addPage();
                yPosition = 20;
            }
            
            const wrappedLines = pdf.splitTextToSize(line, 170);
            pdf.text(wrappedLines, 20, yPosition);
            yPosition += wrappedLines.length * lineHeight + 3;
        });
        
        pdf.save(`${filename}.pdf`);
        alert(currentLang === 'es' ? '隆Carta PDF descargada exitosamente!' : 'PDF letter downloaded successfully!');
        
    } catch (error) {
        console.error('Error generating PDF:', error);
        alert(currentLang === 'es' ? 'Error al generar PDF' : 'Error generating PDF');
    }
}

function downloadLetterAsWord(filename) {
    try {
        const letterContent = document.getElementById('letter-preview');
        const textContent = letterContent.innerText || letterContent.textContent;
        
        const html = `
            <html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word">
            <head>
                <meta charset="utf-8">
                <title>Carta de Presentaci贸n</title>
                <style>
                    body { 
                        font-family: 'Times New Roman', serif; 
                        font-size: 12pt; 
                        line-height: 1.6; 
                        margin: 40px;
                        color: #000;
                    }
                </style>
            </head>
            <body>
                <div style="white-space: pre-line;">${textContent}</div>
            </body>
            </html>
        `;
        
        const blob = new Blob(['\ufeff', html], { type: 'application/msword' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `${filename}.doc`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        alert(currentLang === 'es' ? '隆Carta Word descargada exitosamente!' : 'Word letter downloaded successfully!');
        
    } catch (error) {
        console.error('Error generating Word:', error);
        alert(currentLang === 'es' ? 'Error al generar Word' : 'Error generating Word');
    }
}

</script>

<!-- Modal de Carta de Presentaci贸n Profesional -->
<div id="professional-letter-modal" class="professional-letter-modal">
    <div class="professional-letter-content">
        <div class="letter-header">
            <h2 id="prof-letter-title"> Carta de Presentaci贸n Profesional</h2>
            <p id="prof-letter-subtitle">Formato basado en est谩ndares profesionales</p>
        </div>

        <div class="letter-form-section">
            <h3 class="section-title" id="sender-info-title">Tu Informaci贸n</h3>
            <div class="form-group">
                <label>
                    <input type="checkbox" id="use-resume-data" checked onchange="toggleResumeData()">
                    <span id="use-resume-label">Usar datos del resum茅</span>
                </label>
            </div>
            
            <div class="form-group">
                <label id="sender-name-label">Nombre Completo:</label>
                <input type="text" id="sender-name" oninput="updateLetterPreview()">
            </div>
            
            <div class="form-group">
                <label id="sender-address-label">Direcci贸n:</label>
                <input type="text" id="sender-address" oninput="updateLetterPreview()">
            </div>
            
            <div class="form-group">
                <label id="sender-phone-label">Tel茅fono:</label>
                <input type="text" id="sender-phone" oninput="updateLetterPreview()">
            </div>
            
            <div class="form-group">
                <label id="sender-email-label">Email:</label>
                <input type="email" id="sender-email" oninput="updateLetterPreview()">
            </div>

            <h3 class="section-title" id="company-info-title">Informaci贸n de la Empresa</h3>
            
            <div class="form-group">
                <label id="company-name-label">Nombre de la Empresa:</label>
                <input type="text" id="company-name" placeholder="Universidad Ana G. M茅ndez" oninput="updateLetterPreview()">
            </div>
            
            <div class="form-group">
                <label id="company-address-label">Direcci贸n de la Empresa:</label>
                <textarea id="company-address" rows="3" placeholder="Carretera 176&#10;Avenida Ana G. M茅ndez&#10;Km 0.3, San Juan, P.R. 00928" oninput="updateLetterPreview()"></textarea>
            </div>
            
            <div class="form-group">
                <label id="department-label">Departamento/rea:</label>
                <input type="text" id="department" placeholder="Oficina de Recursos Humanos" oninput="updateLetterPreview()">
            </div>

            <h3 class="section-title" id="position-info-title">Informaci贸n del Puesto</h3>
            
            <div class="form-group">
                <label id="position-title-label">T铆tulo del Puesto:</label>
                <input type="text" id="position-title" placeholder="Director(a) Asociado(a) de Colocaciones" oninput="updateLetterPreview()">
            </div>
            
            <div class="form-group">
                <label id="job-source-label">Donde viste la oferta:</label>
                <input type="text" id="job-source" placeholder="p谩gina web de su instituci贸n" oninput="updateLetterPreview()">
            </div>

            <h3 class="section-title" id="content-title">Contenido Personalizado</h3>
            
            <div class="form-group">
                <label id="expertise-area-label">Tu 谩rea de expertise:</label>
                <input type="text" id="expertise-area" placeholder="reclutamiento, colocaciones y asuntos acad茅micos" oninput="updateLetterPreview()">
            </div>
            
            <div class="form-group">
                <label id="additional-info-label">Informaci贸n adicional (opcional):</label>
                <textarea id="additional-info" rows="3" placeholder="Cualquier informaci贸n extra que quieras agregar..." oninput="updateLetterPreview()"></textarea>
            </div>
        </div>

        <div class="letter-preview-section">
            <div class="letter-preview-content" id="letter-preview">
                <!-- El contenido se genera din谩micamente -->
            </div>
        </div>

        <div class="letter-buttons">
            <button class="btn btn-primary" onclick="downloadProfessionalLetter('pdf')" id="prof-download-pdf"> Descargar PDF</button>
            <button class="btn btn-primary" onclick="downloadProfessionalLetter('word')" id="prof-download-word"> Descargar Word</button>
            <button class="btn" onclick="closeProfessionalLetter()" id="prof-close">Cerrar</button>
        </div>
    </div>
</div>

<div id="exit-modal" class="email-modal" style="display: none;">
    <div class="email-modal-content" style="max-width: 400px; text-align: center;">
        <div class="email-modal-header">
            <h3 id="exit-modal-title">隆Gracias por usar UAGM Resume Builder!</h3>
        </div>
        <div class="email-modal-body">
            <img src="logo blanco.png" alt="UAGM Logo" style="height: 80px; margin-bottom: 20px; filter: invert(1);">
            <p style="margin-bottom: 20px; color: #4a5568;">Universidad Ana G. M茅ndez<br>Oficina de Carreras y Colocaciones</p>
            <p style="margin-bottom: 20px; font-size: 14px; color: #718096;">Esperamos que tu resum茅 te ayude a conseguir el trabajo deseado.</p>
            <div class="email-modal-buttons">
                <button class="btn btn-primary" onclick="closeApplication()">Cerrar Aplicaci贸n</button>
                <button class="btn" onclick="closeExitModal()">Continuar</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal de Encuesta de Satisfacci贸n -->
<div id="survey-modal" class="survey-modal" style="display: none;">
    <div class="survey-modal-content">
        <div class="survey-modal-header">
            <h3 id="survey-title"> Encuesta de Satisfacci贸n</h3>
            <p id="survey-subtitle">Tu opini贸n nos ayuda a mejorar</p>
        </div>
        <div class="survey-modal-body">
            <!-- Pregunta 1 -->
            <div class="survey-question">
                <h4 id="survey-q1">驴Qu茅 tan satisfecho est谩s en c贸mo esta aplicaci贸n prepar贸 tu resum茅?</h4>
                <div class="satisfaction-options">
                    <label class="satisfaction-option">
                        <input type="radio" name="q1-satisfaction" value="muy-satisfecho">
                        <span id="q1-muy">Muy Satisfecho</span>
                    </label>
                    <label class="satisfaction-option">
                        <input type="radio" name="q1-satisfaction" value="satisfecho">
                        <span id="q1-satisfecho">Satisfecho</span>
                    </label>
                    <label class="satisfaction-option">
                        <input type="radio" name="q1-satisfaction" value="neutral">
                        <span id="q1-neutral">Neutral</span>
                    </label>
                    <label class="satisfaction-option">
                        <input type="radio" name="q1-satisfaction" value="poco-satisfecho">
                        <span id="q1-poco">Poco Satisfecho</span>
                    </label>
                </div>
            </div>

            <!-- Pregunta 2 -->
            <div class="survey-question">
                <h4 id="survey-q2">驴Qu茅 tan efectiva consideras esta herramienta como apoyo de la universidad para tu inserci贸n laboral?</h4>
                <div class="satisfaction-options">
                    <label class="satisfaction-option">
                        <input type="radio" name="q2-effectiveness" value="muy-satisfecho">
                        <span id="q2-muy">Muy Satisfecho</span>
                    </label>
                    <label class="satisfaction-option">
                        <input type="radio" name="q2-effectiveness" value="satisfecho">
                        <span id="q2-satisfecho">Satisfecho</span>
                    </label>
                    <label class="satisfaction-option">
                        <input type="radio" name="q2-effectiveness" value="neutral">
                        <span id="q2-neutral">Neutral</span>
                    </label>
                    <label class="satisfaction-option">
                        <input type="radio" name="q2-effectiveness" value="poco-satisfecho">
                        <span id="q2-poco">Poco Satisfecho</span>
                    </label>
                </div>
            </div>

            <!-- Pregunta 3 -->
            <div class="survey-question">
                <h4 id="survey-q3">驴Qu茅 tan 煤til fue esta aplicaci贸n para superar dificultades en la creaci贸n de tu resum茅 profesional?</h4>
                <div class="satisfaction-options">
                    <label class="satisfaction-option">
                        <input type="radio" name="q3-usefulness" value="muy-satisfecho">
                        <span id="q3-muy">Muy Satisfecho</span>
                    </label>
                    <label class="satisfaction-option">
                        <input type="radio" name="q3-usefulness" value="satisfecho">
                        <span id="q3-satisfecho">Satisfecho</span>
                    </label>
                    <label class="satisfaction-option">
                        <input type="radio" name="q3-usefulness" value="neutral">
                        <span id="q3-neutral">Neutral</span>
                    </label>
                    <label class="satisfaction-option">
                        <input type="radio" name="q3-usefulness" value="poco-satisfecho">
                        <span id="q3-poco">Poco Satisfecho</span>
                    </label>
                </div>
            </div>

            <!-- Pregunta 4 -->
            <div class="survey-question">
                <h4 id="survey-q4">驴Qu茅 tan satisfecho est谩s con la facilidad de uso de la aplicaci贸n?</h4>
                <div class="satisfaction-options">
                    <label class="satisfaction-option">
                        <input type="radio" name="q4-usability" value="muy-satisfecho">
                        <span id="q4-muy">Muy Satisfecho</span>
                    </label>
                    <label class="satisfaction-option">
                        <input type="radio" name="q4-usability" value="satisfecho">
                        <span id="q4-satisfecho">Satisfecho</span>
                    </label>
                    <label class="satisfaction-option">
                        <input type="radio" name="q4-usability" value="neutral">
                        <span id="q4-neutral">Neutral</span>
                    </label>
                    <label class="satisfaction-option">
                        <input type="radio" name="q4-usability" value="poco-satisfecho">
                        <span id="q4-poco">Poco Satisfecho</span>
                    </label>
                </div>
            </div>

            <!-- Pregunta 5: Comentarios -->
            <div class="survey-question">
                <h4 id="survey-q5">Comentarios adicionales o sugerencias:</h4>
                <textarea id="survey-comments" rows="4" style="width: 100%; padding: 10px; border: 2px solid #e2e8f0; border-radius: 5px; resize: vertical;" placeholder="Escribe tus comentarios aqu铆..."></textarea>
            </div>

            <div class="survey-buttons">
                <button class="btn btn-primary" id="survey-submit-btn" onclick="submitSurveyAndExit()">Enviar Encuesta y Salir</button>
            </div>
        </div>
    </div>
</div>

</body>
</html>

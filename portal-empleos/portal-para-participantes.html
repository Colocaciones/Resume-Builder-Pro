<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal Participantes - UAGM</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
<!-- Scripts Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
       body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0;
    padding: 0;
    overflow-x: hidden;
    background: white;
}
        
        .container {
    width: 100%;
    max-width: 100%;
    margin: 0;
    padding: 0;
    background: white;
}
        
        /* HERO SECTION PARTICIPANTES */
.hero-section-participants {
    position: relative;
    min-height: 50vh;
    display: flex;
    align-items: center;
    justify-content: center;
    background: url('https://images.unsplash.com/photo-1521737711867-e3b97375f902?w=1920') center/cover no-repeat;
    overflow: hidden;
}
.hero-section-participants::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: url('data:image/svg+xml,<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="2" fill="white" opacity="0.1"/></svg>');
    animation: float 20s linear infinite;
}

@keyframes gradientShift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

@keyframes float {
    from { transform: translateY(0); }
    to { transform: translateY(-100px); }
}

.hero-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.6);
}
.hero-content-participants {
    position: relative;
    z-index: 10;
    text-align: center;
    color: white;
    padding: 40px;
    animation: fadeInUp 1s ease;
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.hero-logo-participants {
    height: 100px;
    margin-bottom: 20px;
    filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3));
}

.hero-title-participants {
    font-size: 42px;
    font-weight: 800;
    margin-bottom: 15px;
    text-shadow: 2px 2px 8px rgba(0,0,0,0.4);
    color: white;
}

.hero-tagline-participants {
    font-size: 20px;
    font-weight: 300;
    text-shadow: 1px 1px 4px rgba(0,0,0,0.4);
    color: white;
}

.back-btn-hero {
    position: absolute;
    top: 20px;
    left: 20px;
    background: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
    color: white;
    border: 2px solid rgba(255, 255, 255, 0.3);
    padding: 12px 20px;
    border-radius: 50px;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: 600;
    z-index: 100;
}

.back-btn-hero:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: translateX(-5px);
}

/* Responsive Hero Participantes */
@media (max-width: 768px) {
    .hero-section-participants {
        min-height: 40vh;
    }
    
    .hero-title-participants {
        font-size: 28px;
    }
    
    .hero-tagline-participants {
        font-size: 16px;
    }
    
    .hero-logo-participants {
        height: 70px;
    }
}
        
        .main-content {
    max-width: 1200px;
    margin: 0 auto;
    padding: 60px 40px;
    background: white;
}
        
        .welcome-section {
    text-align: center;
    margin-bottom: 50px;
    padding: 30px;
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    border-radius: 15px;
}

.welcome-section h2 {
    color: #c8102e;
    margin-bottom: 15px;
    font-size: 32px;
    font-weight: 700;
}

.welcome-section p {
    color: #6c757d;
    font-size: 18px;
    line-height: 1.6;
}
        
        .tabs {
    display: flex;
    margin-bottom: 40px;
    border-bottom: 3px solid #e2e8f0;
    gap: 10px;
    background: #f8f9fa;
    padding: 10px;
    border-radius: 15px 15px 0 0;
}

.tab {
    flex: 1;
    padding: 18px 25px;
    background: transparent;
    border: none;
    font-size: 17px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    border-radius: 10px;
    color: #6c757d;
}

.tab.active {
    color: white;
    background: linear-gradient(135deg, #c8102e 0%, #8b0b1f 100%);
    transform: translateY(-3px);
    box-shadow: 0 5px 15px rgba(200, 16, 46, 0.3);
}

.tab:hover:not(.active) {
    background: rgba(200, 16, 46, 0.1);
    color: #c8102e;
    transform: translateY(-2px);
}
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .section-title {
    font-size: 24px;
    color: #c8102e;
    margin-bottom: 30px;
    margin-top: 40px;
    padding: 15px 20px;
    background: linear-gradient(135deg, rgba(200, 16, 46, 0.1) 0%, rgba(139, 11, 31, 0.05) 100%);
    border-left: 5px solid #c8102e;
    border-radius: 8px;
    display: flex;
    align-items: center;
    gap: 12px;
    font-weight: 700;
}

.section-title i {
    font-size: 28px;
}
        
        .form-group {
    margin-bottom: 25px;
}

.form-group label {
    display: block;
    margin-bottom: 10px;
    font-weight: 600;
    color: #2d3748;
    font-size: 15px;
}

.required {
    color: #dc3545;
    font-size: 18px;
}

.form-group input,
.form-group select,
.form-group textarea {
    width: 100%;
    padding: 14px 18px;
    border: 2px solid #e2e8f0;
    border-radius: 10px;
    font-size: 15px;
    transition: all 0.3s ease;
    background: white;
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
    outline: none;
    border-color: #c8102e;
    box-shadow: 0 0 0 4px rgba(200, 16, 46, 0.1);
    transform: translateY(-2px);
}

.form-group input:hover,
.form-group select:hover,
.form-group textarea:hover {
    border-color: #c8102e;
}
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .file-upload {
    position: relative;
    display: inline-block;
    width: 100%;
}

.file-upload input[type="file"] {
    position: absolute;
    opacity: 0;
    width: 100%;
    height: 100%;
    cursor: pointer;
}

.file-upload-label {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    padding: 30px;
    border: 3px dashed #c8102e;
    border-radius: 15px;
    background: rgba(200, 16, 46, 0.05);
    color: #c8102e;
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    font-weight: 600;
    font-size: 16px;
}

.file-upload-label i {
    font-size: 28px;
}

.file-upload-label:hover {
    background: rgba(200, 16, 46, 0.15);
    border-color: #8b0b1f;
    transform: translateY(-3px);
    box-shadow: 0 5px 15px rgba(200, 16, 46, 0.2);
}

.file-upload.has-file .file-upload-label {
    background: linear-gradient(135deg, #d1ecf1 0%, #bee5eb 100%);
    border-color: #17a2b8;
    color: #0c5460;
    box-shadow: 0 5px 15px rgba(23, 162, 184, 0.2);
}
        
        .btn {
    padding: 15px 35px;
    border: none;
    border-radius: 50px;
    font-weight: 600;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    display: inline-flex;
    align-items: center;
    gap: 10px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
}

.btn-primary {
    background: linear-gradient(135deg, #c8102e 0%, #8b0b1f 100%);
    color: white;
}

.btn-primary:hover {
    background: linear-gradient(135deg, #a00d26 0%, #6d0918 100%);
    transform: translateY(-3px);
    box-shadow: 0 6px 20px rgba(200, 16, 46, 0.4);
}

.btn-secondary {
    background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
    color: white;
}

.btn-secondary:hover {
    background: linear-gradient(135deg, #5a6268 0%, #495057 100%);
    transform: translateY(-3px);
    box-shadow: 0 6px 20px rgba(108, 117, 125, 0.4);
}

.btn-small {
    padding: 10px 20px;
    font-size: 14px;
}
        
        .offers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }
        
        .offer-card {
    background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
    border: 2px solid #e2e8f0;
    border-radius: 20px;
    padding: 30px;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    cursor: pointer;
    box-shadow: 0 4px 15px rgba(0,0,0,0.08);
}

.offer-card:hover {
    border-color: #c8102e;
    transform: translateY(-10px) scale(1.02);
    box-shadow: 0 20px 40px rgba(200, 16, 46, 0.15);
    background: white;
}
        
        .offer-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }
        
        .company-name {
            font-size: 18px;
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 5px;
        }
        
        .position-title {
            font-size: 16px;
            color: #c8102e;
            font-weight: 600;
        }
        
        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .status-active {
            background: #d1ecf1;
            color: #0c5460;
        }
        
        .status-expiring {
            background: #fff3cd;
            color: #856404;
        }
        
        .offer-details {
            margin: 15px 0;
        }
        
        .offer-detail {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
            font-size: 14px;
            color: #6c757d;
        }
        
        .offer-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .btn-small {
            padding: 8px 16px;
            font-size: 14px;
        }
        
        .modal {
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            display: none;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
    background: white;
    border-radius: 20px;
    width: 90%;
    max-width: 800px;
    max-height: 90vh;
    overflow-y: auto;
    position: relative;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    animation: modalAppear 0.3s ease;
}

@keyframes modalAppear {
    from {
        opacity: 0;
        transform: scale(0.8) translateY(-20px);
    }
    to {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

.modal-header {
    padding: 30px;
    border-bottom: 2px solid #e2e8f0;
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    border-radius: 20px 20px 0 0;
}

.modal-header h3 {
    color: #c8102e;
    font-size: 24px;
    font-weight: 700;
}

.modal-body {
    padding: 30px;
    line-height: 1.8;
}

.modal-footer {
    padding: 25px 30px;
    border-top: 2px solid #e2e8f0;
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    border-radius: 0 0 20px 20px;
    display: flex;
    justify-content: end;
    gap: 15px;
}
        
        .close {
            position: absolute;
            top: 20px;
            right: 25px;
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .close:hover {
            color: #000;
        }
        
       .success-message {
    background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
    color: white;
    padding: 30px;
    border-radius: 20px;
    text-align: center;
    margin-bottom: 30px;
    display: none;
    box-shadow: 0 10px 30px rgba(40, 167, 69, 0.3);
    animation: successAppear 0.5s ease;
}

@keyframes successAppear {
    from {
        opacity: 0;
        transform: scale(0.9);
    }
    to {
        opacity: 1;
        transform: scale(1);
    }
}

.success-message h3 {
    margin-top: 10px;
    margin-bottom: 10px;
    font-size: 24px;
}

.success-message p {
    font-size: 16px;
    margin: 0;
}
        
        .no-offers {
    text-align: center;
    padding: 80px 40px;
    color: #6c757d;
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    border-radius: 20px;
    margin: 20px 0;
}

.no-offers i {
    font-size: 80px;
    margin-bottom: 25px;
    opacity: 0.4;
    color: #c8102e;
}

.no-offers h3 {
    font-size: 28px;
    color: #2d3748;
    margin-bottom: 15px;
    font-weight: 700;
}

.no-offers p {
    font-size: 18px;
    line-height: 1.6;
}
        
        @media (max-width: 768px) {
    .container {
        margin: 0;
    }
    
    .main-content {
        padding: 30px 20px;
    }
    
    .welcome-section {
        padding: 20px;
    }
    
    .welcome-section h2 {
        font-size: 24px;
    }
    
    .welcome-section p {
        font-size: 16px;
    }
    
    .tabs {
        flex-direction: column;
        gap: 10px;
        padding: 15px;
    }
    
    .tab {
        width: 100%;
        padding: 15px 20px;
    }
    
    .section-title {
        font-size: 20px;
        padding: 12px 15px;
    }
    
    .section-title i {
        font-size: 22px;
    }
    
    .form-row {
        grid-template-columns: 1fr;
    }
    
    .offers-grid {
        grid-template-columns: 1fr;
    }
    
    .offer-card {
        padding: 20px;
    }
    
    .modal-content {
        width: 95%;
        margin: 10px;
    }
    
    .modal-header,
    .modal-body,
    .modal-footer {
        padding: 20px;
    }
    
    .btn {
        width: 100%;
        justify-content: center;
    }
    
    .back-btn-hero {
        padding: 10px 15px;
        font-size: 14px;
    }
}

.search-filter-bar {
    display: flex;
    gap: 15px;
    margin-bottom: 20px;
    flex-wrap: wrap;
    align-items: center;
}

.search-input {
    flex: 1;
    min-width: 250px;
    padding: 12px 15px;
    border: 2px solid #e2e8f0;
    border-radius: 8px;
    font-size: 14px;
    transition: border-color 0.3s ease;
}

.search-input:focus {
    outline: none;
    border-color: #c8102e;
    box-shadow: 0 0 0 3px rgba(200, 16, 46, 0.1);
}

.filter-select {
    padding: 12px 15px;
    border: 2px solid #e2e8f0;
    border-radius: 8px;
    font-size: 14px;
    background: white;
    min-width: 150px;
}

.filter-select:focus {
    outline: none;
    border-color: #c8102e;
}

@media (max-width: 768px) {
    .search-filter-bar {
        flex-direction: column;
    }
    
    .search-input {
        min-width: 100%;
    }
}

    </style>
</head>
<body>
    <div class="container">
        <!-- HERO SECTION -->
<div class="hero-section-participants">
    <div class="hero-overlay"></div>
    <button class="back-btn-hero" onclick="goBack()">
        <i class="fas fa-arrow-left"></i> Volver al Portal Principal
    </button>
    <div class="hero-content-participants">
        <h1 class="hero-title-participants"><i class="fas fa-users"></i> Portal para Participantes</h1>
        <p class="hero-tagline-participants">Reg√≠strate y accede a ofertas de empleo exclusivas de UAGM</p>
    </div>
</div>

        <div class="main-content">
            <div class="success-message" id="successMessage">
                <i class="fas fa-check-circle" style="font-size: 24px; margin-bottom: 10px;"></i>
                <h3>¬°Registro Completado Exitosamente!</h3>
                <p>Ya puedes explorar las ofertas de empleo disponibles.</p>
            </div>

            <div class="tabs">
                <button class="tab active" onclick="switchTab('register')">
                    <i class="fas fa-user-plus"></i> Registro
                </button>
                <button class="tab" onclick="switchTab('offers')" id="offersTab">
                    <i class="fas fa-briefcase"></i> Ofertas de Empleo
                </button>
            </div>

            <!-- Tab Registro -->
            <div class="tab-content active" id="registerContent">
                <form id="registrationForm">
                    <!-- Informaci√≥n Personal -->
                    <div class="section-title">
                        <i class="fas fa-user"></i>
                        Informaci√≥n Personal
                    </div>

                    <div class="form-group">
                        <label>Tipo de participante <span class="required">*</span></label>
                        <select id="participantType" required>
                            <option value="">Seleccionar...</option>
                            <option value="new">Nuevo</option>
                            <option value="returning">Participante de Seguimiento (He recibido los servicios anteriormente)</option>
                        </select>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Nombre <span class="required">*</span></label>
                            <input type="text" id="firstName" required>
                        </div>
                        <div class="form-group">
                            <label>Apellidos <span class="required">*</span></label>
                            <input type="text" id="lastName" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Tel√©fono <span class="required">*</span></label>
                            <input type="tel" id="phone" required placeholder="787-555-1234">
                        </div>
                        <div class="form-group">
                            <label>Correo electr√≥nico <span class="required">*</span></label>
                            <input type="email" id="email" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Pueblo al que pertenece <span class="required">*</span></label>
                        <input type="text" id="city" required placeholder="Ej: San Juan">
                    </div>

                    <!-- Informaci√≥n Acad√©mica -->
                    <div class="section-title">
                        <i class="fas fa-graduation-cap"></i>
                        Informaci√≥n Acad√©mica
                    </div>

                    <div class="form-group">
                        <label>¬øEres Estudiante, Exalumno de UAGM o Comunidad? <span class="required">*</span></label>
                        <select id="studentType" required>
                            <option value="">Seleccionar...</option>
                            <option value="student">Estudiante</option>
                            <option value="alumni">Exalumno</option>
                            <option value="community">Comunidad</option>
                        </select>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Recinto o Centro Universitario al que pertenece <span class="required">*</span></label>
                            <select id="campus" required>
                                <option value="">Seleccionar...</option>
                                <option value="cupey">Recinto de Cupey</option>
                                <option value="bayamon">Centro Universitario de Bayam√≥n</option>
                                <option value="aguadilla">Centro Universitario de Aguadilla</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>ID Estudiante (S0...) <span class="required">*</span></label>
                            <input type="text" id="studentId" required placeholder="S0123456789">
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>Horario de Estudios <span class="required">*</span></label>
                            <select id="schedule" required>
                                <option value="">Seleccionar...</option>
                                <option value="diurno">Diurno</option>
                                <option value="nocturno">Nocturno</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>A√±o de estudios <span class="required">*</span></label>
                            <select id="studyYear" required>
                                <option value="">Seleccionar...</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Concentraci√≥n <span class="required">*</span></label>
                        <input type="text" id="concentration" required placeholder="Ej: Administraci√≥n de Empresas">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>¬øEres candidato a graduaci√≥n para este a√±o? <span class="required">*</span></label>
                            <select id="graduationCandidate" required>
                                <option value="">Seleccionar...</option>
                                <option value="yes">S√≠</option>
                                <option value="no">No</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Grado Acad√©mico obtenido o en curso <span class="required">*</span></label>
                            <select id="academicDegree" required>
                                <option value="">Seleccionar...</option>
                                <option value="11mo">11mo √≥ menos</option>
                                <option value="cuarto">Cuarto A√±o</option>
                                <option value="certificado">Certificado</option>
                                <option value="asociado">Grado Asociado</option>
                                <option value="bachillerato">Bachillerato</option>
                                <option value="maestria">Maestr√≠a</option>
                                <option value="doctorado">Doctorado</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Divisi√≥n Acad√©mica <span class="required">*</span></label>
                        <select id="academicDivision" required>
                            <option value="">Seleccionar...</option>
                            <option value="negocios">Negocios, Turismo y Emprendimiento</option>
                            <option value="salud">Ciencias de la Salud</option>
                            <option value="liberales">Artes Liberales</option>
                            <option value="tecnologia">Ciencias y Tecnolog√≠a</option>
                            <option value="tecnicos">Programas T√©cnicos</option>
                        </select>
                    </div>

                    <!-- Resum√© -->
                    <div class="section-title">
                        <i class="fas fa-file-upload"></i>
                        Resum√©
                    </div>

                    <div class="form-group">
                        <label>Subir Resum√© (PDF recomendado) <span class="required">*</span></label>
                        <div class="file-upload" id="resumeUpload">
                            <input type="file" id="resume" accept=".pdf,.doc,.docx" required>
                            <div class="file-upload-label">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <span>Haz clic para seleccionar tu resum√©</span>
                            </div>
                        </div>
                    </div>

                    <div style="text-align: center; margin-top: 40px;">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-user-check"></i> Completar Registro
                        </button>
                    </div>
                </form>
            </div>

            <!-- Tab Ofertas -->
            <div class="tab-content" id="offersContent">
                <div class="section-title">
    <i class="fas fa-search"></i>
    Ofertas de Empleo Disponibles
</div>

<div class="search-filter-bar">
    <input type="text" class="search-input" id="offersSearch" placeholder="üîç Buscar por empresa, posici√≥n o ubicaci√≥n..." oninput="filterOffers()">
    <select class="filter-select" id="statusFilter" onchange="filterOffers()">
        <option value="">Todas las ofertas</option>
        <option value="active">Solo activas</option>
        <option value="expiring">Vencen pronto</option>
    </select>
</div>

                <div id="offersContainer">
                    <div class="no-offers">
                        <i class="fas fa-info-circle"></i>
                        <h3>Reg√≠strate para ver ofertas</h3>
                        <p>Completa tu registro para acceder a las ofertas de empleo disponibles</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Detalles de Oferta -->
    <div id="offerModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Detalles de la Oferta</h3>
                <span class="close" onclick="closeOfferModal()">&times;</span>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- Contenido din√°mico -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeOfferModal()">Cerrar</button>
                <button class="btn btn-primary" onclick="applyToOffer()" id="applyBtn">
                    <i class="fas fa-paper-plane"></i> Aplicar a esta Oferta
                </button>
            </div>
        </div>
    </div>
<script>
        // Configuraci√≥n Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyBFgSuKNJMUoVcKgHjsqOsInArSPBsb32A",
            authDomain: "uagm-portal-de-empleo-17aed.firebaseapp.com",
            projectId: "uagm-portal-de-empleo-17aed",
            storageBucket: "uagm-portal-de-empleo-17aed.firebasestorage.app",
            messagingSenderId: "582147767835",
            appId: "1:582147767835:web:546ab8f2557b6da6ccc2be"
        };

        // Variables globales Firebase
        let app, db, auth, storage;
        let isFirebaseInitialized = false;

        // Variables globales
        let currentUser = null;
        let currentOffer = null;
        let offers = [];
let promoOfferId = null; // Variable global para promoci√≥n

// ===== SISTEMA DE PROMOCI√ìN DE OFERTAS =====
function checkForPromotion() {
    const urlParams = new URLSearchParams(window.location.search);
    promoOfferId = urlParams.get('promo');
    
    if (promoOfferId) {
        console.log('üéØ Modo promoci√≥n activado para oferta:', promoOfferId);
        
        // Esperar a que las ofertas se carguen
        setTimeout(() => {
            const promoOffer = offers.find(offer => offer.id === promoOfferId);
            
            if (promoOffer) {
                // Actualizar el header con info de la oferta
                updateHeaderForPromotion(promoOffer);
                
                // Ocultar el tab de ofertas
                document.getElementById('offersTab').style.display = 'none';
                
                // Ir al tab de registro
                switchTab('register');
                
                // NUEVO: Filtrar las ofertas para mostrar solo la promocionada
                offers = [promoOffer]; // ‚Üê CLAVE: Sobrescribir array de ofertas
                
            } else {
                console.log('‚ùå Oferta no encontrada:', promoOfferId);
            }
        }, 1500);
    }
}
function updateHeaderForPromotion(offer) {
    // Buscar o crear la secci√≥n de bienvenida
    let welcomeSection = document.querySelector('.welcome-section');
    
    if (!welcomeSection) {
        // Si no existe, crearla
        welcomeSection = document.createElement('div');
        welcomeSection.className = 'welcome-section';
        
        // Insertarla ANTES de los tabs
        const mainContent = document.querySelector('.main-content');
        const tabs = document.querySelector('.tabs');
        mainContent.insertBefore(welcomeSection, tabs);
    }
    
    // Ahora s√≠, modificar el contenido
    welcomeSection.innerHTML = `
        <div style="background: linear-gradient(135deg, #c8102e 0%, #8b0b1f 100%); color: white; padding: 30px; border-radius: 15px; margin-bottom: 30px; box-shadow: 0 10px 30px rgba(200,16,46,0.3);">
            <div style="text-align: center; margin-bottom: 20px;">
                <i class="fas fa-star" style="font-size: 48px; color: #ffd700; margin-bottom: 15px;"></i>
                <h2 style="color: white; margin-bottom: 10px; font-size: 28px;">‚ú® Oferta Exclusiva para Ti</h2>
                <p style="color: rgba(255,255,255,0.9); font-size: 16px;">Has sido referido para esta posici√≥n especial</p>
            </div>
            
            <div style="background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); padding: 20px; border-radius: 12px; border: 2px solid rgba(255,255,255,0.2);">
                <h3 style="color: white; margin-bottom: 15px; font-size: 24px; text-align: center;">
                    <i class="fas fa-briefcase"></i> ${offer.position}
                </h3>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                    <div style="background: rgba(255,255,255,0.1); padding: 12px; border-radius: 8px;">
                        <p style="font-size: 14px; color: rgba(255,255,255,0.8); margin-bottom: 5px;">üè¢ Empresa</p>
                        <p style="font-size: 16px; color: white; font-weight: 600; margin: 0;">${offer.companyName}</p>
                    </div>
                    <div style="background: rgba(255,255,255,0.1); padding: 12px; border-radius: 8px;">
                        <p style="font-size: 14px; color: rgba(255,255,255,0.8); margin-bottom: 5px;">üìç Ubicaci√≥n</p>
                        <p style="font-size: 16px; color: white; font-weight: 600; margin: 0;">${offer.location}</p>
                    </div>
                </div>
                
                ${offer.schedule ? `
                <div style="background: rgba(255,255,255,0.1); padding: 12px; border-radius: 8px; margin-bottom: 15px;">
                    <p style="font-size: 14px; color: rgba(255,255,255,0.8); margin-bottom: 5px;">üïê Horario</p>
                    <p style="font-size: 16px; color: white; font-weight: 600; margin: 0;">${offer.schedule}</p>
                </div>
                ` : ''}
                
                <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                    <h4 style="color: white; margin-bottom: 10px; font-size: 16px;">
                        <i class="fas fa-clipboard-check"></i> Requisitos de la Posici√≥n
                    </h4>
                    <p style="font-size: 14px; color: white; line-height: 1.6; margin: 0;">${offer.requirements}</p>
                </div>
            </div>
            
            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 12px; margin-top: 20px; text-align: center;">
                <p style="color: white; font-size: 15px; margin: 0;">
                    <i class="fas fa-arrow-down"></i> <strong>Completa tu registro abajo para aplicar autom√°ticamente</strong>
                </p>
            </div>
        </div>
    `;
    
    // Ocultar el tab de ofertas
    const offersTab = document.getElementById('offersTab');
    if (offersTab) {
        offersTab.style.display = 'none';
    }
    
    // Bloquear navegaci√≥n al tab de ofertas
    window.originalSwitchTab = window.switchTab;
    window.switchTab = function(tabName) {
        if (tabName === 'offers' && promoOfferId) {
            console.log('üö´ Navegaci√≥n a ofertas bloqueada en modo promoci√≥n');
            return;
        }
        window.originalSwitchTab(tabName);
    };
}
function initializeFirebase() {
            try {
                app = firebase.initializeApp(firebaseConfig);
                db = firebase.firestore();
                auth = firebase.auth();
                storage = firebase.storage();
                console.log('Firebase inicializado correctamente');
                return true;
            } catch (error) {
                console.error('Error inicializando Firebase:', error);
                return false;
            }
        }

        const FirebaseHelper = {
            async saveDoc(collection, data) {
                try {
                    const docRef = await db.collection(collection).add(data);
                    return { success: true, id: docRef.id };
                } catch (error) {
                    console.error('Error guardando documento:', error);
                    return { success: false, error };
                }
            },
            
            async getDocs(collection) {
                try {
                    const snapshot = await db.collection(collection).get();
                    const docs = [];
                    snapshot.forEach(doc => {
                        docs.push({ id: doc.id, ...doc.data() });
                    });
                    return { success: true, docs };
                } catch (error) {
                    console.error('Error obteniendo documentos:', error);
                    return { success: false, error };
                }
            }
        };

        document.addEventListener('DOMContentLoaded', async function() {
    isFirebaseInitialized = initializeFirebase();
    await loadOffers();
    setupFileUpload();
    setupConditionalFields();
    checkForPromotion(); // MOVER AQU√ç
    console.log('Portal Participantes cargado correctamente');

        });

        // Volver a p√°gina principal
        function goBack() {
            window.location.href = 'Portal pagina principal.html';
        }

        // Cambiar entre tabs
        function switchTab(tabName) {
            // Actualizar tabs
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            if (tabName === 'register') {
                document.querySelector('.tab').classList.add('active');
                document.getElementById('registerContent').classList.add('active');
            } else if (tabName === 'offers') {
                document.querySelectorAll('.tab')[1].classList.add('active');
                document.getElementById('offersContent').classList.add('active');
                loadOffersDisplay();
            }
        }

// Controlar campos condicionales seg√∫n tipo de estudiante
        function toggleStudentFields() {
            const studentType = document.getElementById('studentType').value;
            const studentOnlyFields = [
                'campus',
                'studentId', 
                'schedule',
                'studyYear',
                'academicDivision',
                'graduationCandidate'
            ];

            if (studentType === 'student') {
                // Mostrar campos para estudiantes
                studentOnlyFields.forEach(fieldId => {
                    const field = document.getElementById(fieldId);
                    const formGroup = field.closest('.form-group');
                    formGroup.style.display = 'block';
                    field.required = true;
                });
            } else if (studentType === 'alumni' || studentType === 'community') {
                // Ocultar campos para exalumnos y comunidad
                studentOnlyFields.forEach(fieldId => {
                    const field = document.getElementById(fieldId);
                    const formGroup = field.closest('.form-group');
                    formGroup.style.display = 'none';
                    field.required = false;
                    field.value = ''; // Limpiar valor
                });
            }
        }

        // Configurar upload de archivos
        function setupFileUpload() {
            const fileInput = document.getElementById('resume');
            const uploadContainer = document.getElementById('resumeUpload');
            const label = uploadContainer.querySelector('.file-upload-label span');

            fileInput.addEventListener('change', function() {
                if (this.files.length > 0) {
                    const file = this.files[0];
                    const fileName = file.name;
                    const fileSize = (file.size / 1024 / 1024).toFixed(2);
                    
                    label.textContent = `${fileName} (${fileSize} MB)`;
                    uploadContainer.classList.add('has-file');
                    
                    showNotification(`Archivo seleccionado: ${fileName}`, 'success');
                } else {
                    label.textContent = 'Haz clic para seleccionar tu resum√©';
                    uploadContainer.classList.remove('has-file');
                }
            });
        }

// Configurar eventos para campos condicionales
        function setupConditionalFields() {
            const studentTypeSelect = document.getElementById('studentType');
            
            // Agregar evento cuando cambie la selecci√≥n
            studentTypeSelect.addEventListener('change', toggleStudentFields);
            
            // Ejecutar al cargar la p√°gina para estado inicial
            toggleStudentFields();
        }

        // Manejar registro
        document.getElementById('registrationForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (!validateRegistrationForm()) {
                return;
            }

            submitRegistration();
        });

        // Validar formulario de registro
        function validateRegistrationForm() {
            const studentType = document.getElementById('studentType').value;
            let requiredFields = [
                'participantType', 'firstName', 'lastName', 'phone', 'email', 'city',
                'studentType', 'concentration', 'academicDegree'
            ];

            // Agregar campos adicionales solo si es estudiante
            if (studentType === 'student') {
                requiredFields = requiredFields.concat([
                    'campus', 'studentId', 'schedule', 'studyYear', 
                    'academicDivision', 'graduationCandidate'
                ]);
            }

            for (let fieldId of requiredFields) {
                const field = document.getElementById(fieldId);
                if (!field.value.trim()) {
                    field.focus();
                    showNotification(`Por favor completa: ${field.previousElementSibling.textContent}`, 'error');
                    return false;
                }
            }

            // Validar email
            const email = document.getElementById('email').value;
            if (!isValidEmail(email)) {
                document.getElementById('email').focus();
                showNotification('Por favor ingresa un email v√°lido', 'error');
                return false;
            }

            // Validar archivo
            const fileInput = document.getElementById('resume');
            if (!fileInput.files.length) {
                showNotification('Por favor selecciona tu resum√©', 'error');
                return false;
            }

           // Validar ID estudiante solo si es estudiante
            if (studentType === 'student') {
                const studentId = document.getElementById('studentId').value;
                if (!studentId.toLowerCase().startsWith('s0')) {
                    document.getElementById('studentId').focus();
                    showNotification('El ID debe comenzar con S0', 'error');
                    return false;
                }
            }
            return true;
        }

        // Validar email
        function isValidEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }

        // Enviar registro
async function submitRegistration() {
    const formData = {
        id: Date.now().toString(),
        participantType: document.getElementById('participantType').value,
        firstName: document.getElementById('firstName').value,
        lastName: document.getElementById('lastName').value,
        phone: document.getElementById('phone').value,
        email: document.getElementById('email').value,
        city: document.getElementById('city').value,
        studentType: document.getElementById('studentType').value,
        campus: document.getElementById('campus').value,
        studentId: document.getElementById('studentId').value,
        schedule: document.getElementById('schedule').value,
        studyYear: document.getElementById('studyYear').value,
        concentration: document.getElementById('concentration').value,
        graduationCandidate: document.getElementById('graduationCandidate').value,
        academicDegree: document.getElementById('academicDegree').value,
        academicDivision: document.getElementById('academicDivision').value,
        resume: 'uploading...', // Se actualizar√° despu√©s de subir
        registeredAt: new Date().toISOString()
    };

    try {
        // Subir archivo de resum√© a Storage
        const resumeFile = document.getElementById('resume').files[0];
        if (resumeFile) {
            const storageRef = storage.ref(`resumes/${formData.id}_${resumeFile.name}`);
            const uploadTask = await storageRef.put(resumeFile);
            const downloadURL = await uploadTask.ref.getDownloadURL();
            formData.resume = downloadURL;
            formData.resumeFileName = resumeFile.name;
            console.log('Resum√© subido a Storage:', downloadURL);
        }

        // Intentar guardar en Firebase
        if (isFirebaseInitialized) {
            const result = await FirebaseHelper.saveDoc('participants', formData);
            if (result.success) {
                console.log('Participante guardado en Firebase:', result.id);
                showNotification('¬°Registro y resum√© guardados en Firebase!', 'success');
            } else {
                throw new Error('Error de Firebase');
            }
        } else {
            throw new Error('Firebase no inicializado');
        }
    } catch (error) {
        console.error('Error con Firebase, usando localStorage:', error);
        showNotification('Guardado localmente (Firebase fall√≥)', 'warning');
    }

    // Guardar tambi√©n en localStorage como respaldo
    localStorage.setItem('currentUser', JSON.stringify(formData));
    let participants = JSON.parse(localStorage.getItem('participants')) || [];
    participants.push(formData);
    localStorage.setItem('participants', JSON.stringify(participants));

    currentUser = formData;
if (promoOfferId) {
    createAutoApplication(formData, promoOfferId);
}

    // Mostrar mensaje de √©xito
    document.getElementById('successMessage').style.display = 'block';
    document.getElementById('offersTab').style.display = 'flex';
    
    showNotification('¬°Registro completado exitosamente!', 'success');

    // Cambiar a tab de ofertas despu√©s de 2 segundos
    setTimeout(() => {
        switchTab('offers');
    }, 2000);
}

async function createAutoApplication(participantData, offerId) {
    const offer = offers.find(o => o.id === offerId);
    if (!offer) {
        console.error('‚ùå Oferta no encontrada para auto-aplicaci√≥n');
        return;
    }
    
    console.log('üìù Creando aplicaci√≥n autom√°tica para:', offer.position);
    
    const autoApplication = {
        id: Date.now().toString() + '_promo',
        offerId: offerId,
        participantId: participantData.id,
        participantData: participantData,
        offerData: offer,
        participantName: `${participantData.firstName} ${participantData.lastName}`,
        participantEmail: participantData.email,
        participantPhone: participantData.phone,
        offerTitle: offer.position,
        companyName: offer.companyName,
        appliedAt: new Date().toISOString(),
        status: 'pending',
        source: 'promotional_link',
        adminReview: {
            reviewed: false,
            reviewedBy: null,
            reviewedAt: null,
            decision: null,
            notes: 'üîó Aplicaci√≥n autom√°tica v√≠a enlace promocional'
        }
    };
    
    try {
        if (isFirebaseInitialized) {
            const result = await FirebaseHelper.saveDoc('applications', autoApplication);
            if (result.success) {
                console.log('‚úÖ Aplicaci√≥n autom√°tica guardada en Firebase:', result.id);
            }
        }
        
        let applications = JSON.parse(localStorage.getItem('applications')) || [];
        applications.push(autoApplication);
        localStorage.setItem('applications', JSON.stringify(applications));
        
        console.log('‚úÖ Aplicaci√≥n guardada localmente');
        
    } catch (error) {
        console.error('‚ùå Error creando aplicaci√≥n:', error);
    }

    // Mostrar mensaje final de confirmaci√≥n
    setTimeout(() => {
        document.querySelector('.welcome-section').innerHTML = `
            <div style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; padding: 40px; border-radius: 15px; text-align: center;">
                <i class="fas fa-check-circle" style="font-size: 64px; margin-bottom: 20px;"></i>
                <h2 style="color: white; margin-bottom: 15px;">¬°Solicitud Completada Exitosamente!</h2>
                <p style="font-size: 18px; margin-bottom: 10px;">Tu aplicaci√≥n para <strong>${offer.position}</strong> en <strong>${offer.companyName}</strong> ha sido enviada.</p>
                <p style="font-size: 16px; opacity: 0.95; margin-bottom: 20px;">Nuestro equipo revisar√° tu perfil y se pondr√° en contacto contigo pronto.</p>
                <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; margin-top: 20px;">
                    <p style="font-size: 14px; margin: 0;">üìß Recibir√°s un correo de confirmaci√≥n a: <strong>${participantData.email}</strong></p>
                </div>
            </div>
        `;
        
        // Ocultar el formulario de registro
        document.getElementById('registerContent').style.display = 'none';
        
    }, 2000);
}

       // Cargar ofertas desde Firebase
        async function loadOffers() {
            try {
                if (isFirebaseInitialized) {
                    const result = await FirebaseHelper.getDocs('jobOffers');
                    if (result.success) {
                        offers = result.docs;
                        console.log('Ofertas cargadas desde Firebase:', offers.length);
                    } else {
                        throw new Error('Error cargando desde Firebase');
                    }
                } else {
                    throw new Error('Firebase no inicializado');
                }
            } catch (error) {
                console.error('Error cargando ofertas desde Firebase, usando localStorage:', error);
                offers = JSON.parse(localStorage.getItem('jobOffers')) || [];
            }
        }

        // Mostrar ofertas
        function loadOffersDisplay() {
            const container = document.getElementById('offersContainer');
            
            if (!currentUser) {
                container.innerHTML = `
                    <div class="no-offers">
                        <i class="fas fa-info-circle"></i>
                        <h3>Reg√≠strate para ver ofertas</h3>
                        <p>Completa tu registro para acceder a las ofertas de empleo disponibles</p>
                    </div>
                `;
                return;
            }

            if (offers.length === 0) {
                container.innerHTML = `
                    <div class="no-offers">
                        <i class="fas fa-briefcase"></i>
                        <h3>No hay ofertas disponibles</h3>
                        <p>Pronto habr√° nuevas oportunidades laborales disponibles</p>
                    </div>
                `;
                return;
            }

            let html = '<div class="offers-grid">';
            
            offers.forEach(offer => {
                const status = getOfferStatus(offer.deadline);
                const statusClass = status === 'expired' ? 'status-expired' : 
                                  status === 'expiring' ? 'status-expiring' : 'status-active';
                const statusText = status === 'expired' ? 'Vencida' : 
                                 status === 'expiring' ? 'Vence Pronto' : 'Activa';

                // Solo mostrar ofertas activas
                if (status !== 'expired') {
                    html += `
                        <div class="offer-card" onclick="viewOfferDetails('${offer.id}')">
                            <div class="offer-header">
                                <div>
                                    <div class="company-name">${offer.companyName}</div>
                                    <div class="position-title">${offer.position}</div>
                                </div>
                                <span class="status-badge ${statusClass}">${statusText}</span>
                            </div>
                            
                            <div class="offer-details">
                                <div class="offer-detail">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <span>${offer.location}</span>
                                </div>
                            <div class="offer-detail">
                                    <i class="fas fa-clock"></i>
                                    <span>${getTypeLabel(offer.positionType)}</span>
                                </div>
                                <div class="offer-detail">
                                    <i class="fas fa-calendar-alt"></i>
                                    <span>Vence: ${new Date(offer.deadline).toLocaleDateString()}</span>
                                </div>
                            </div>
                            
                            <div class="offer-actions">
                                <button class="btn btn-primary btn-small" onclick="event.stopPropagation(); viewOfferDetails('${offer.id}')">
                                    <i class="fas fa-eye"></i> Ver Detalles
                                </button>
                            </div>
                        </div>
                    `;
                }
            });
            
            html += '</div>';
            container.innerHTML = html;
        }

// Filtrar ofertas
function filterOffers() {
    const search = document.getElementById('offersSearch').value.toLowerCase();
    const statusFilter = document.getElementById('statusFilter').value;
    
    let filteredOffers = offers;
    
    // Filtro de b√∫squeda por texto
    if (search) {
        filteredOffers = filteredOffers.filter(offer => 
            offer.companyName.toLowerCase().includes(search) ||
            offer.position.toLowerCase().includes(search) ||
            offer.location.toLowerCase().includes(search) ||
            (offer.requirements && offer.requirements.toLowerCase().includes(search))
        );
    }
    
    // Filtro por estado
    if (statusFilter) {
        filteredOffers = filteredOffers.filter(offer => {
            const status = getOfferStatus(offer.deadline);
            return status === statusFilter;
        });
    }
    
    displayFilteredOffers(filteredOffers);
}

// Mostrar ofertas filtradas
function displayFilteredOffers(filteredOffers) {
    const container = document.getElementById('offersContainer');
    
    if (!currentUser) {
        container.innerHTML = `
            <div class="no-offers">
                <i class="fas fa-info-circle"></i>
                <h3>Reg√≠strate para ver ofertas</h3>
                <p>Completa tu registro para acceder a las ofertas de empleo disponibles</p>
            </div>
        `;
        return;
    }

    if (filteredOffers.length === 0) {
        container.innerHTML = `
            <div class="no-offers">
                <i class="fas fa-search"></i>
                <h3>No se encontraron ofertas</h3>
                <p>No hay ofertas que coincidan con tu b√∫squeda</p>
            </div>
        `;
        return;
    }

    let html = '<div class="offers-grid">';
    
    filteredOffers.forEach(offer => {
        const status = getOfferStatus(offer.deadline);
        const statusClass = status === 'expired' ? 'status-expired' : 
                          status === 'expiring' ? 'status-expiring' : 'status-active';
        const statusText = status === 'expired' ? 'Vencida' : 
                         status === 'expiring' ? 'Vence Pronto' : 'Activa';

        // Solo mostrar ofertas activas
        if (status !== 'expired') {
            html += `
                <div class="offer-card" onclick="viewOfferDetails('${offer.id}')">
                    <div class="offer-header">
                        <div>
                            <div class="company-name">${offer.companyName}</div>
                            <div class="position-title">${offer.position}</div>
                        </div>
                        <span class="status-badge ${statusClass}">${statusText}</span>
                    </div>
                    
                    <div class="offer-details">
                        <div class="offer-detail">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>${offer.location}</span>
                        </div>
                        <div class="offer-detail">
                            <i class="fas fa-clock"></i>
                            <span>${getTypeLabel(offer.positionType)}</span>
                        </div>
                        <div class="offer-detail">
                            <i class="fas fa-calendar-alt"></i>
                            <span>Vence: ${new Date(offer.deadline).toLocaleDateString()}</span>
                        </div>
                    </div>
                    
                    <div class="offer-actions">
                        <button class="btn btn-primary btn-small" onclick="event.stopPropagation(); viewOfferDetails('${offer.id}')">
                            <i class="fas fa-eye"></i> Ver Detalles
                        </button>
                    </div>
                </div>
            `;
        }
    });
    
    html += '</div>';
    container.innerHTML = html;
}

        // Obtener estado de oferta
        function getOfferStatus(deadline) {
            const today = new Date();
            const deadlineDate = new Date(deadline);
            const diffTime = deadlineDate - today;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

            if (diffDays < 0) return 'expired';
            if (diffDays <= 7) return 'expiring';
            return 'active';
        }

        // Obtener etiqueta de tipo
        function getTypeLabel(type) {
            const labels = {
                'part-time': 'Part-Time',
                'full-time': 'Full-Time',
                'regular': 'Regular',
                'temporary': 'Temporero'
            };
            return labels[type] || type;
        }

        // Ver detalles de oferta
        function viewOfferDetails(offerId) {
            const offer = offers.find(o => o.id === offerId);
            if (!offer) return;

            currentOffer = offer;

            const activities = offer.activities ? offer.activities.map(act => {
                const labels = {
                    'feria': 'Ferias de Empleo',
                    'mesas': 'Mesas de reclutamiento',
                    'talleres': 'Ofrecimiento de Talleres',
                    'no': 'No participan en actividades'
                };
                return labels[act] || act;
            }).join(', ') : 'No especificadas';

            document.getElementById('modalTitle').textContent = `${offer.position} - ${offer.companyName}`;
            document.getElementById('modalBody').innerHTML = `
    <div style="margin-bottom: 20px;">
        <h4 style="color: #c8102e; margin-bottom: 15px;">Informaci√≥n de la Empresa</h4>
        <p><strong>Empresa:</strong> ${offer.companyName}</p>
        <p><strong>Ubicaci√≥n:</strong> ${offer.location}</p>
    </div>
    
    <div style="margin-bottom: 20px;">
        <h4 style="color: #c8102e; margin-bottom: 15px;">Detalles del Puesto</h4>
        <p><strong>Posici√≥n:</strong> ${offer.position}</p>
        <p><strong>Tipo:</strong> ${getTypeLabel(offer.positionType)}</p>
        <p><strong>Fecha L√≠mite:</strong> ${new Date(offer.deadline).toLocaleDateString()}</p>
    </div>
                </div>
                
                ${offer.jobDescription ? `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #c8102e; margin-bottom: 10px;">Descripci√≥n del Puesto</h4>
                    <p style="background: #f8f9fa; padding: 15px; border-radius: 6px;">${offer.jobDescription}</p>
                </div>
                ` : ''}
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #c8102e; margin-bottom: 10px;">Requisitos</h4>
                    <p style="background: #f8f9fa; padding: 15px; border-radius: 6px;">${offer.requirements}</p>
                </div>
                
                ${offer.schedule ? `
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #c8102e; margin-bottom: 10px;">Horarios</h4>
                    <p style="background: #f8f9fa; padding: 15px; border-radius: 6px;">${offer.schedule}</p>
                </div>
                ` : ''}
            `;

            document.getElementById('offerModal').style.display = 'flex';
        }

        // Cerrar modal
        function closeOfferModal() {
            document.getElementById('offerModal').style.display = 'none';
            currentOffer = null;
        }

        // Aplicar a oferta
async function applyToOffer() {
    if (!currentOffer || !currentUser) return;

    // Crear aplicaci√≥n con estado PENDING (nuevo)
    const application = {
        id: Date.now().toString(),
        offerId: currentOffer.id,
        participantId: currentUser.id,
        participantData: currentUser, // Datos completos del participante
        offerData: currentOffer, // Datos completos de la oferta
        participantName: `${currentUser.firstName} ${currentUser.lastName}`,
        participantEmail: currentUser.email,
        participantPhone: currentUser.phone,
        offerTitle: currentOffer.position,
        companyName: currentOffer.companyName,
        appliedAt: new Date().toISOString(),
        status: 'pending', // ‚Üê CAMBIO CLAVE: Inicia como pendiente
        adminReview: {
            reviewed: false,
            reviewedBy: null,
            reviewedAt: null,
            decision: null,
            notes: ''
        }
    };

    try {
        // Intentar guardar en Firebase
        if (isFirebaseInitialized) {
            const result = await FirebaseHelper.saveDoc('applications', application);
            if (result.success) {
                console.log('Aplicaci√≥n guardada en Firebase:', result.id);
                showNotification('¬°Aplicaci√≥n enviada para revisi√≥n!', 'success');
            } else {
                throw new Error('Error de Firebase');
            }
        } else {
            throw new Error('Firebase no inicializado');
        }
    } catch (error) {
        console.error('Error con Firebase, usando localStorage:', error);
        showNotification('Aplicaci√≥n enviada (guardada localmente)', 'warning');
    }

    // Guardar tambi√©n en localStorage como respaldo
    let applications = JSON.parse(localStorage.getItem('applications')) || [];
    applications.push(application);
    localStorage.setItem('applications', JSON.stringify(applications));

    closeOfferModal();
    
    // Mensaje actualizado
    showNotification('Solicitud enviada para revisi√≥n por nuestro equipo', 'info');
}

        // Sistema de notificaciones
        function showNotification(message, type = 'info') {
            const existingNotification = document.querySelector('.notification');
            if (existingNotification) {
                existingNotification.remove();
            }

            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                border-radius: 10px;
                color: white;
                font-weight: 600;
                z-index: 10000;
                animation: slideIn 0.3s ease;
                max-width: 350px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            `;
            
            const colors = {
                success: '#28a745',
                error: '#dc3545',
                warning: '#ffc107',
                info: '#17a2b8'
            };
            
            notification.style.backgroundColor = colors[type] || colors.info;
            
            const icons = {
                success: 'fas fa-check-circle',
                error: 'fas fa-exclamation-circle',
                warning: 'fas fa-exclamation-triangle',
                info: 'fas fa-info-circle'
            };
            
            notification.innerHTML = `
                <i class="${icons[type] || icons.info}" style="margin-right: 10px;"></i>
                ${message}
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.style.animation = 'slideOut 0.3s ease';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.remove();
                        }
                    }, 300);
                }
            }, 4000);
        }

        // Cerrar modal al hacer clic fuera
        window.onclick = function(event) {
            const modal = document.getElementById('offerModal');
            if (event.target === modal) {
                closeOfferModal();
            }
        }

        // Agregar animaciones CSS
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>

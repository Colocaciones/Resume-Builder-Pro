<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: Arial, sans-serif;
            background: #f5f5f5;
            color: #333;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: linear-gradient(135deg, #c8102e 0%, #8b0b1f 100%);
            color: white;
            padding: 30px;
            text-align: center;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        
        .controls {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
        }
        
        .btn-primary { background: #667eea; color: white; }
        .btn-add { background: #38a169; color: white; margin-top: 10px; }
        .btn-remove { background: #e53e3e; color: white; }
        .btn-small { padding: 6px 12px; font-size: 12px; }
        
        select, input, textarea {
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        .form-section, .preview-section {
            background: white;
            padding: 30px;
            border-radius: 10px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #4a5568;
        }
        
        .form-group input, .form-group textarea {
            width: 100%;
        }
        
        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }
        
        .section-title {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #2d3748;
            border-bottom: 2px solid #667eea;
            padding-bottom: 5px;
        }
        
        .dynamic-section {
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            background: #f9f9f9;
            position: relative;
        }
        
        .remove-btn {
            position: absolute;
            top: 10px;
            right: 10px;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .skill-item {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            align-items: center;
        }
        
        .skill-item input { flex: 1; }
        .skill-item select { width: 120px; }
        
        .resume-preview {
            background: white;
            padding: 40px;
            min-height: 600px;
        }
        
        /* Templates */
        .template-modern .name {
            font-size: 32px;
            color: #2d3748;
            margin-bottom: 10px;
        }
        
        .template-modern .resume-header {
            border-bottom: 3px solid #667eea;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        
        .template-creative .resume-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            margin: -40px -40px 30px -40px;
            text-align: center;
        }
        
        .template-minimal .resume-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .template-minimal .name {
            font-size: 28px;
            font-weight: 300;
            letter-spacing: 2px;
            text-transform: uppercase;
        }
        
        .template-elegant .resume-header {
            background-color: #1a202c;
            color: white;
            padding: 30px;
            text-align: center;
            margin: -40px -40px 30px -40px;
        }
        
        .template-clean .resume-header {
            border-bottom: 3px solid #48bb78;
            padding-bottom: 20px;
        }
        
        .template-clean .name {
            color: #2f855a;
            font-size: 30px;
        }
        
        .template-corporate .resume-header {
            background: linear-gradient(to right, #2b6cb0, #2c5282);
            color: white;
            padding: 20px;
            margin: -40px -40px 30px -40px;
        }
        
        .contact-info {
            color: #718096;
            font-size: 14px;
        }
        
        .resume-section {
            margin-bottom: 25px;
        }
        
        .resume-section h3 {
            color: #2d3748;
            border-bottom: 2px solid #667eea;
            padding-bottom: 5px;
            margin-bottom: 15px;
        }
        
        .experience-item, .education-item {
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .job-title, .degree-title {
            font-weight: bold;
            color: #2d3748;
        }
        
        .company-info, .institution-info {
            color: #718096;
            font-size: 14px;
            margin-bottom: 5px;
        }
        
        .skills-category {
            margin-bottom: 15px;
        }
        
        .skills-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .skill-tag {
            background: #667eea;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
        }
        
        @media (max-width: 768px) {
            .main-content { grid-template-columns: 1fr; }
            .form-row { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <p style="font-size: 18px; margin-bottom: 5px;">Oficina de Carreras y Colocaciones Recinto de Cupey</p>
            <h1 id="app-title">Resume Builder Pro</h1>
            <p id="app-subtitle">Crea tu currículum profesional en minutos</p>
        </div>

        <div class="controls">
            <select id="language-select">
                <option value="es">Español</option>
                <option value="en">English</option>
            </select>
            <select id="template-select">
                <option value="modern">Moderno</option>
                <option value="creative">Creativo</option>
                <option value="minimal">Minimalista</option>
                <option value="elegant">Elegante</option>
                <option value="clean">Clara</option>
                <option value="corporate">Corporativa</option>
            </select>
            <button class="btn btn-primary" onclick="exportToPDF()">Exportar PDF</button>
            <button class="btn btn-primary" onclick="exportToWord()">Exportar Word</button>
            <button class="btn btn-primary" onclick="clearAll()">Limpiar</button>
        </div>

        <div class="main-content">
            <div class="form-section">
                <h2 class="section-title" id="personal-info-title">Información Personal</h2>
                <div class="form-group">
                    <label id="name-label">Nombre Completo</label>
                    <input type="text" id="name" placeholder="Juan Pérez" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label id="email-label">Correo Electrónico</label>
                    <input type="email" id="email" placeholder="juan.perez@email.com" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label id="phone-label">Teléfono</label>
                    <input type="tel" id="phone" placeholder="+1 234 567 8900" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label id="location-label">Ubicación</label>
                    <input type="text" id="location" placeholder="Ciudad, País" oninput="updatePreview()">
                </div>

                <h2 class="section-title" id="summary-title">Resumen Profesional</h2>
                <div class="form-group">
                    <textarea id="summary" placeholder="Profesional altamente motivado..." oninput="updatePreview()"></textarea>
                </div>

                <h2 class="section-title" id="experience-title">Experiencia Laboral</h2>
                <div id="experience-container"></div>
                <button class="btn btn-add btn-small" onclick="addExperience()" id="add-experience-btn">+ Agregar Experiencia</button>

                <h2 class="section-title" id="education-title">Educación</h2>
                <div id="education-container"></div>
                <button class="btn btn-add btn-small" onclick="addEducation()" id="add-education-btn">+ Agregar Educación</button>

                <h2 class="section-title" id="skills-title">Habilidades</h2>
                <div id="skills-container"></div>
                <button class="btn btn-add btn-small" onclick="addSkillCategory()" id="add-skill-btn">+ Agregar Categoría</button>
            </div>

            <div class="preview-section">
                <h2 class="section-title" id="preview-title">Vista Previa</h2>
                <div id="resume-preview" class="resume-preview template-modern">
                    <div class="resume-header">
                        <h1 class="name" id="preview-name">Tu Nombre</h1>
                        <div class="contact-info">
                            <span id="preview-email">email@ejemplo.com</span> | 
                            <span id="preview-phone">+1 234 567 8900</span> | 
                            <span id="preview-location">Ciudad, País</span>
                        </div>
                    </div>
                    
                    <div class="resume-section">
                        <h3 id="preview-summary-title">Resumen Profesional</h3>
                        <p id="preview-summary">Tu resumen profesional aparecerá aquí...</p>
                    </div>

                    <div class="resume-section">
                        <h3 id="preview-experience-title">Experiencia Laboral</h3>
                        <div id="preview-experience">Tu experiencia laboral aparecerá aquí...</div>
                    </div>

                    <div class="resume-section">
                        <h3 id="preview-education-title">Educación</h3>
                        <div id="preview-education">Tu educación aparecerá aquí...</div>
                    </div>

                    <div class="resume-section">
                        <h3 id="preview-skills-title">Habilidades</h3>
                        <div id="preview-skills">Tus habilidades aparecerán aquí...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

<script>
let currentLang = 'es';
let expCount = 0;
let eduCount = 0;
let skillCount = 0;

const texts = {
    es: {
        appTitle: "Resume Builder Pro",
        appSubtitle: "Crea tu currículum profesional en minutos",
        personalInfoTitle: "Información Personal",
        nameLabel: "Nombre Completo",
        emailLabel: "Correo Electrónico",
        phoneLabel: "Teléfono",
        locationLabel: "Ubicación",
        summaryTitle: "Resumen Profesional",
        experienceTitle: "Experiencia Laboral",
        educationTitle: "Educación",
        skillsTitle: "Habilidades",
        previewTitle: "Vista Previa",
        addExperience: "+ Agregar Experiencia",
        addEducation: "+ Agregar Educación",
        addSkill: "+ Agregar Categoría",
        position: "Posición/Cargo",
        company: "Empresa",
        startDate: "Fecha Inicio",
        endDate: "Fecha Fin",
        current: "Trabajo Actual",
        tasks: "Tareas y Responsabilidades",
        degree: "Título/Grado",
        institution: "Institución",
        year: "Año",
        description: "Descripción",
        skillCategory: "Categoría",
        skillName: "Habilidad",
        skillLevel: "Nivel",
        remove: "Eliminar",
        addSkillBtn: "+ Agregar Habilidad",
        levels: {
            beginner: "Principiante",
            intermediate: "Intermedio",
            advanced: "Avanzado",
            expert: "Experto"
        },
        templates: {
            modern: "Moderno",
            creative: "Creativo",
            minimal: "Minimalista",
            elegant: "Elegante",
            clean: "Clara",
            corporate: "Corporativa"
        }
    },
    en: {
        appTitle: "Resume Builder Pro",
        appSubtitle: "Create your professional resume in minutes",
        personalInfoTitle: "Personal Information",
        nameLabel: "Full Name",
        emailLabel: "Email",
        phoneLabel: "Phone",
        locationLabel: "Location",
        summaryTitle: "Professional Summary",
        experienceTitle: "Work Experience",
        educationTitle: "Education",
        skillsTitle: "Skills",
        previewTitle: "Preview",
        addExperience: "+ Add Experience",
        addEducation: "+ Add Education",
        addSkill: "+ Add Category",
        position: "Position/Title",
        company: "Company",
        startDate: "Start Date",
        endDate: "End Date",
        current: "Current Job",
        tasks: "Tasks and Responsibilities",
        degree: "Degree/Title",
        institution: "Institution",
        year: "Year",
        description: "Description",
        skillCategory: "Category",
        skillName: "Skill",
        skillLevel: "Level",
        remove: "Remove",
        addSkillBtn: "+ Add Skill",
        levels: {
            beginner: "Beginner",
            intermediate: "Intermediate",
            advanced: "Advanced",
            expert: "Expert"
        },
        templates: {
            modern: "Modern",
            creative: "Creative",
            minimal: "Minimal",
            elegant: "Elegant",
            clean: "Clean",
            corporate: "Corporate"
        }
    }
};

// Inicializar cuando se carga la página
window.addEventListener('load', function() {
    setupEvents();
    addExperience();
    addEducation();
    addSkillCategory();
    updatePreview();
});

function setupEvents() {
    // Cambio de idioma
    document.getElementById('language-select').onchange = function() {
        currentLang = this.value;
        updateLanguage();
        updateTemplateOptions();
    };

    // Cambio de plantilla
    document.getElementById('template-select').onchange = function() {
        document.getElementById('resume-preview').className = 'resume-preview template-' + this.value;
    };
}

function updateLanguage() {
    const t = texts[currentLang];
    
    document.getElementById('app-title').textContent = t.appTitle;
    document.getElementById('app-subtitle').textContent = t.appSubtitle;
    document.getElementById('personal-info-title').textContent = t.personalInfoTitle;
    document.getElementById('name-label').textContent = t.nameLabel;
    document.getElementById('email-label').textContent = t.emailLabel;
    document.getElementById('phone-label').textContent = t.phoneLabel;
    document.getElementById('location-label').textContent = t.locationLabel;
    document.getElementById('summary-title').textContent = t.summaryTitle;
    document.getElementById('experience-title').textContent = t.experienceTitle;
    document.getElementById('education-title').textContent = t.educationTitle;
    document.getElementById('skills-title').textContent = t.skillsTitle;
    document.getElementById('preview-title').textContent = t.previewTitle;
    document.getElementById('add-experience-btn').textContent = t.addExperience;
    document.getElementById('add-education-btn').textContent = t.addEducation;
    document.getElementById('add-skill-btn').textContent = t.addSkill;

    document.getElementById('preview-summary-title').textContent = t.summaryTitle;
    document.getElementById('preview-experience-title').textContent = t.experienceTitle;
    document.getElementById('preview-education-title').textContent = t.educationTitle;
    document.getElementById('preview-skills-title').textContent = t.skillsTitle;
}

function updateTemplateOptions() {
    const select = document.getElementById('template-select');
    const current = select.value;
    const t = texts[currentLang].templates;
    
    select.innerHTML = `
        <option value="modern">${t.modern}</option>
        <option value="creative">${t.creative}</option>
        <option value="minimal">${t.minimal}</option>
        <option value="elegant">${t.elegant}</option>
        <option value="clean">${t.clean}</option>
        <option value="corporate">${t.corporate}</option>
    `;
    select.value = current;
}

function addExperience() {
    const container = document.getElementById('experience-container');
    const t = texts[currentLang];
    const id = expCount++;
    
    const html = `
        <div class="dynamic-section" id="exp-${id}">
            <button class="btn btn-remove btn-small remove-btn" onclick="removeItem('exp-${id}')">
                ${t.remove}
            </button>
            <h4>${t.experienceTitle} ${id + 1}</h4>
            
            <div class="form-row">
                <div class="form-group">
                    <label>${t.position}</label>
                    <input type="text" class="exp-position" placeholder="Desarrollador Senior" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label>${t.company}</label>
                    <input type="text" class="exp-company" placeholder="Empresa XYZ" oninput="updatePreview()">
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label>${t.startDate}</label>
                    <input type="text" class="exp-start" placeholder="2020" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label>${t.endDate}</label>
                    <input type="text" class="exp-end" placeholder="Presente" oninput="updatePreview()">
                </div>
            </div>
            
            <div class="form-group">
                <label>
                    <input type="checkbox" class="exp-current" onchange="updatePreview()">
                    ${t.current}
                </label>
            </div>
            
            <div class="form-group">
                <label>${t.tasks}</label>
                <textarea class="exp-tasks" placeholder="• Desarrollo de aplicaciones web" oninput="updatePreview()"></textarea>
            </div>
        </div>
    `;
    
    container.insertAdjacentHTML('beforeend', html);
    updatePreview();
}

function addEducation() {
    const container = document.getElementById('education-container');
    const t = texts[currentLang];
    const id = eduCount++;
    
    const html = `
        <div class="dynamic-section" id="edu-${id}">
            <button class="btn btn-remove btn-small remove-btn" onclick="removeItem('edu-${id}')">
                ${t.remove}
            </button>
            <h4>${t.educationTitle} ${id + 1}</h4>
            
            <div class="form-row">
                <div class="form-group">
                    <label>${t.degree}</label>
                    <input type="text" class="edu-degree" placeholder="Licenciatura en Ciencias" oninput="updatePreview()">
                </div>
                <div class="form-group">
                    <label>${t.institution}</label>
                    <input type="text" class="edu-institution" placeholder="Universidad Nacional" oninput="updatePreview()">
                </div>
            </div>
            
            <div class="form-group">
                <label>${t.year}</label>
                <input type="text" class="edu-year" placeholder="2015-2019" oninput="updatePreview()">
            </div>
            
            <div class="form-group">
                <label>${t.description}</label>
                <textarea class="edu-description" placeholder="Descripción adicional..." oninput="updatePreview()"></textarea>
            </div>
        </div>
    `;
    
    container.insertAdjacentHTML('beforeend', html);
    updatePreview();
}

function addSkillCategory() {
    const container = document.getElementById('skills-container');
    const t = texts[currentLang];
    const id = skillCount++;
    
    const html = `
        <div class="dynamic-section" id="skill-cat-${id}">
            <button class="btn btn-remove btn-small remove-btn" onclick="removeItem('skill-cat-${id}')">
                ${t.remove}
            </button>
            <h4>${t.skillsTitle} ${id + 1}</h4>
            
            <div class="form-group">
                <label>${t.skillCategory}</label>
                <input type="text" class="skill-category-name" placeholder="Técnicas" oninput="updatePreview()">
            </div>
            
            <div class="skills-list" id="skills-list-${id}"></div>
            
            <button class="btn btn-add btn-small" onclick="addSkill(${id})">
                ${t.addSkillBtn}
            </button>
        </div>
    `;
    
    container.insertAdjacentHTML('beforeend', html);
    addSkill(id);
    updatePreview();
}

function addSkill(categoryId) {
    const container = document.getElementById(`skills-list-${categoryId}`);
    const t = texts[currentLang];
    const skillId = Date.now();
    
    const html = `
        <div class="skill-item" id="skill-${skillId}">
            <input type="text" class="skill-name" placeholder="${t.skillName}" oninput="updatePreview()">
            <select class="skill-level" oninput="updatePreview()">
                <option value="beginner">${t.levels.beginner}</option>
                <option value="intermediate">${t.levels.intermediate}</option>
                <option value="advanced">${t.levels.advanced}</option>
                <option value="expert">${t.levels.expert}</option>
            </select>
            <button class="btn btn-remove btn-small" onclick="removeItem('skill-${skillId}')">
                ${t.remove}
            </button>
        </div>
    `;
    
    container.insertAdjacentHTML('beforeend', html);
    updatePreview();
}

function removeItem(id) {
    const element = document.getElementById(id);
    if (element) {
        element.remove();
        updatePreview();
    }
}

function updatePreview() {
    // Información personal
    document.getElementById('preview-name').textContent = 
        document.getElementById('name').value || (currentLang === 'es' ? 'Tu Nombre' : 'Your Name');
    document.getElementById('preview-email').textContent = 
        document.getElementById('email').value || 'email@ejemplo.com';
    document.getElementById('preview-phone').textContent = 
        document.getElementById('phone').value || '+1 234 567 8900';
    document.getElementById('preview-location').textContent = 
        document.getElementById('location').value || (currentLang === 'es' ? 'Ciudad, País' : 'City, Country');
    
    // Resumen
    const summary = document.getElementById('summary').value;
    document.getElementById('preview-summary').innerHTML = 
        summary ? summary.replace(/\n/g, '<br>') : 
        (currentLang === 'es' ? 'Tu resumen profesional aparecerá aquí...' : 'Your professional summary will appear here...');
    
    // Experiencias
    updateExperiencePreview();
    updateEducationPreview();
    updateSkillsPreview();
}

function updateExperiencePreview() {
    const container = document.getElementById('preview-experience');
    let html = '';
    
    const experiences = document.querySelectorAll('#experience-container .dynamic-section');
    experiences.forEach((exp) => {
        const position = exp.querySelector('.exp-position')?.value || '';
        const company = exp.querySelector('.exp-company')?.value || '';
        const startDate = exp.querySelector('.exp-start')?.value || '';
        const endDate = exp.querySelector('.exp-end')?.value || '';
        const tasks = exp.querySelector('.exp-tasks')?.value || '';
        
        if (position || company) {
            html += `
                <div class="experience-item">
                    <div class="job-title">${position}</div>
                    <div class="company-info">${company} | ${startDate} - ${endDate}</div>
                    <div class="job-description">${tasks.replace(/\n/g, '<br>')}</div>
                </div>
            `;
        }
    });
    
    container.innerHTML = html || 
        (currentLang === 'es' ? 'Tu experiencia laboral aparecerá aquí...' : 'Your work experience will appear here...');
}

function updateEducationPreview() {
    const container = document.getElementById('preview-education');
    let html = '';
    
    const educations = document.querySelectorAll('#education-container .dynamic-section');
    educations.forEach((edu) => {
        const degree = edu.querySelector('.edu-degree')?.value || '';
        const institution = edu.querySelector('.edu-institution')?.value || '';
        const year = edu.querySelector('.edu-year')?.value || '';
        const description = edu.querySelector('.edu-description')?.value || '';
        
        if (degree || institution) {
            html += `
                <div class="education-item">
                    <div class="degree-title">${degree}</div>
                    <div class="institution-info">${institution} | ${year}</div>
                    ${description ? `<div>${description}</div>` : ''}
                </div>
            `;
        }
    });
    
    container.innerHTML = html || 
        (currentLang === 'es' ? 'Tu educación aparecerá aquí...' : 'Your education will appear here...');
}

function updateSkillsPreview() {
    const container = document.getElementById('preview-skills');
    let html = '';
    
    const skillCategories = document.querySelectorAll('#skills-container .dynamic-section');
    skillCategories.forEach((cat) => {
        const categoryName = cat.querySelector('.skill-category-name')?.value || '';
        const skills = cat.querySelectorAll('.skill-item');
        
        if (categoryName && skills.length > 0) {
            html += `<div class="skills-category">`;
            html += `<h4>${categoryName}</h4>`;
            html += `<div class="skills-list">`;
            
            skills.forEach((skill) => {
                const skillName = skill.querySelector('.skill-name')?.value || '';
                if (skillName) {
                    html += `<span class="skill-tag">${skillName}</span>`;
                }
            });
            
            html += `</div></div>`;
        }
    });
    
    container.innerHTML = html || 
        (currentLang === 'es' ? 'Tus habilidades aparecerán aquí...' : 'Your skills will appear here...');
}

function clearAll() {
    if (confirm(currentLang === 'es' ? '¿Seguro que quieres limpiar todo?' : 'Are you sure you want to clear everything?')) {
        document.getElementById('name').value = '';
        document.getElementById('email').value = '';
        document.getElementById('phone').value = '';
        document.getElementById('location').value = '';
        document.getElementById('summary').value = '';
        document.getElementById('experience-container').innerHTML = '';
        document.getElementById('education-container').innerHTML = '';
        document.getElementById('skills-container').innerHTML = '';
        
        expCount = 0;
        eduCount = 0;
        skillCount = 0;
        
        addExperience();
        addEducation();
        addSkillCategory();
        updatePreview();
    }
}

// Funciones de exportación
async function exportToPDF() {
    try {
        // Verificar si las librerías están cargadas
        if (typeof window.jspdf === 'undefined' || typeof html2canvas === 'undefined') {
            alert('Las librerías de PDF no están cargadas. Por favor recarga la página.');
            return;
        }

        const { jsPDF } = window.jspdf;
        const element = document.getElementById('resume-preview');
        
        // Crear canvas del elemento
        const canvas = await html2canvas(element, {
            scale: 2,
            useCORS: true,
            logging: false,
            backgroundColor: '#ffffff'
        });
        
        const imgData = canvas.toDataURL('image/png');
        const pdf = new jsPDF({
            orientation: 'portrait',
            unit: 'mm',
            format: 'a4'
        });
        
        const imgWidth = 210;
        const pageHeight = 297;
        const imgHeight = (canvas.height * imgWidth) / canvas.width;
        let heightLeft = imgHeight;
        let position = 0;

        pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
        heightLeft -= pageHeight;

        while (heightLeft >= 0) {
            position = heightLeft - imgHeight;
            pdf.addPage();
            pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
            heightLeft -= pageHeight;
        }

        const fileName = document.getElementById('name').value || 'resume';
        pdf.save(`${fileName}_resume.pdf`);
        
    } catch (error) {
        console.error('Error generando PDF:', error);
        alert('Error al generar el PDF. Intenta de nuevo.');
    }
}

function exportToWord() {
    try {
        const previewContent = document.getElementById('resume-preview').innerHTML;
        const template = document.getElementById('template-select').value;
        
        let styles = `
            <style>
                body { font-family: Arial, sans-serif; margin: 40px; line-height: 1.6; }
                .resume-header { margin-bottom: 30px; }
                .name { font-size: 28px; font-weight: bold; margin-bottom: 10px; }
                .contact-info { color: #666; margin-bottom: 20px; }
                h3 { font-size: 18px; font-weight: bold; margin-top: 25px; margin-bottom: 10px; border-bottom: 2px solid #667eea; padding-bottom: 5px; }
                .resume-section { margin-bottom: 20px; }
                .experience-item, .education-item { margin-bottom: 15px; }
                .job-title, .degree-title { font-weight: bold; }
                .company-info, .institution-info { color: #666; font-size: 14px; }
                .skills-category { margin-bottom: 15px; }
                .skills-list { display: flex; flex-wrap: wrap; gap: 8px; }
                .skill-tag { background: #667eea; color: white; padding: 4px 8px; border-radius: 12px; font-size: 12px; }
        `;

        if (template === 'creative') {
            styles += `
                .resume-header { background: #667eea; color: white; padding: 20px; text-align: center; }
            `;
        } else if (template === 'minimal') {
            styles += `
                .resume-header { text-align: center; }
                .name { font-weight: 300; text-transform: uppercase; letter-spacing: 2px; }
            `;
        }

        styles += '</style>';

        const html = `
            <html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40">
            <head>
                <meta charset="utf-8">
                <title>Resume</title>
                ${styles}
            </head>
            <body>
                ${previewContent}
            </body>
            </html>
        `;

        const blob = new Blob(['\ufeff', html], { 
            type: 'application/msword' 
        });
        
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        const fileName = document.getElementById('name').value || 'resume';
        a.href = url;
        a.download = `${fileName}_resume.doc`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
    } catch (error) {
        console.error('Error al exportar Word:', error);
        alert('Error al exportar a Word');
    }
}
</script>
</body>
</html>
